var OSF=OSF||{};OSF.OUtil=function(){var c=-1,f="&_xdm_Info=",e="_xdm_",a="#",b={},h=3e4,d=false;function g(){return Math.floor(100000001*Math.random()).toString()}return{extend:function(b,a){var c=function(){};c.prototype=a.prototype;b.prototype=new c;b.prototype.constructor=b;b.uber=a.prototype;if(a.prototype.constructor===Object.prototype.constructor)a.prototype.constructor=a},setNamespace:function(b,a){if(a&&b&&!a[b])a[b]={}},unsetNamespace:function(b,a){if(a&&b&&a[b])delete a[b]},loadScript:function(d,e,f){if(d&&e){var j=window.document,a=b[d];if(!a){var c=j.createElement("script");c.type="text/javascript";a={loaded:false,pendingCallbacks:[e],timer:null};b[d]=a;var g=function(){if(a.timer!=null){clearTimeout(a.timer);delete a.timer}a.loaded=true;for(var c=a.pendingCallbacks.length,b=0;b<c;b++){var d=a.pendingCallbacks.shift();d()}},i=function(){delete b[d];if(a.timer!=null){clearTimeout(a.timer);delete a.timer}for(var e=a.pendingCallbacks.length,c=0;c<e;c++){var f=a.pendingCallbacks.shift();f()}};if(c.readyState)c.onreadystatechange=function(){if(c.readyState=="loaded"||c.readyState=="complete"){c.onreadystatechange=null;g()}};else c.onload=g;c.onerror=i;f=f||h;a.timer=setTimeout(i,f);c.src=d;j.getElementsByTagName("head")[0].appendChild(c)}else if(a.loaded)e();else a.pendingCallbacks.push(e)}},loadCSS:function(c){if(c){var b=window.document,a=b.createElement("link");a.type="text/css";a.rel="stylesheet";a.href=c;b.getElementsByTagName("head")[0].appendChild(a)}},parseEnum:function(b,c){var a=c[b.trim()];if(typeof a=="undefined"){OsfMsAjaxFactory.msAjaxDebug.trace("invalid enumeration string:"+b);throw OsfMsAjaxFactory.msAjaxError.argument("str");}return a},delayExecutionAndCache:function(){var a={calc:arguments[0]};return function(){if(a.calc){a.val=a.calc.apply(this,arguments);delete a.calc}return a.val}},getUniqueId:function(){c=c+1;return c.toString()},formatString:function(){var a=arguments,b=a[0];return b.replace(/{(\d+)}/gm,function(d,b){var c=parseInt(b,10)+1;return a[c]===undefined?"{"+b+"}":a[c]})},generateConversationId:function(){return[g(),g(),(+new Date).toString()].join("_")},getFrameNameAndConversationId:function(b,c){var a=e+b+this.generateConversationId();c.setAttribute("name",a);return this.generateConversationId()},addXdmInfoAsHash:function(b,e){b=b.trim()||"";var c=b.split(a),d=c.shift(),g=c.join(a);return[d,a,g,f,e].join("")},parseXdmInfo:function(){var h=window.location.hash,c=h.split(f),a=c.length>1?c[c.length-1]:null;if(window.sessionStorage){var b=window.name.indexOf(e);if(b>-1){var d=window.name.indexOf(";",b);if(d==-1)d=window.name.length;var g=window.name.substring(b,d);if(a)window.sessionStorage.setItem(g,a);else a=window.sessionStorage.getItem(g)}}return a},getConversationId:function(){var b=window.location.search,a=null;if(b){var c=b.indexOf("&");a=c>0?b.substring(1,c):b.substr(1);if(a&&a.charAt(a.length-1)==="="){a=a.substring(0,a.length-1);if(a)a=decodeURIComponent(a)}}return a},validateParamObject:function(d,c,e){var a=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:false},{name:"expectedProperties",type:Object,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true}]);if(a)throw a;for(var b in c){a=Function._validateParameter(d[b],c[b],b);if(a)throw a;}},writeProfilerMark:function(a){if(window.msWriteProfilerMark){window.msWriteProfilerMark(a);OsfMsAjaxFactory.msAjaxDebug.trace(a)}},defineNondefaultProperty:function(d,e,a,b){a=a||{};for(var f in b){var c=b[f];if(a[c]==undefined)a[c]=true}Object.defineProperty(d,e,a);return d},defineNondefaultProperties:function(c,a,d){a=a||{};for(var b in a)OSF.OUtil.defineNondefaultProperty(c,b,a[b],d);return c},defineEnumerableProperty:function(c,b,a){return OSF.OUtil.defineNondefaultProperty(c,b,a,["enumerable"])},defineEnumerableProperties:function(b,a){return OSF.OUtil.defineNondefaultProperties(b,a,["enumerable"])},defineMutableProperty:function(c,b,a){return OSF.OUtil.defineNondefaultProperty(c,b,a,["writable","enumerable","configurable"])},defineMutableProperties:function(b,a){return OSF.OUtil.defineNondefaultProperties(b,a,["writable","enumerable","configurable"])},finalizeProperties:function(c,b){b=b||{};for(var e=Object.getOwnPropertyNames(c),g=e.length,d=0;d<g;d++){var f=e[d],a=Object.getOwnPropertyDescriptor(c,f);if(!a.get&&!a.set)a.writable=b.writable||false;a.configurable=b.configurable||false;a.enumerable=b.enumerable||true;Object.defineProperty(c,f,a)}return c},mapList:function(a,c){var b=[];if(a)for(var d in a)b.push(c(a[d]));return b},listContainsKey:function(b,c){for(var a in b)if(c==a)return true;return false},listContainsValue:function(a,b){for(var c in a)if(b==a[c])return true;return false},augmentList:function(a,b){var d=a.push?function(c,b){a.push(b)}:function(c,b){a[c]=b};for(var c in b)d(c,b[c])},redefineList:function(a,b){for(var d in a)delete a[d];for(var c in b)a[c]=b[c]},isArray:function(a){return Object.prototype.toString.apply(a)==="[object Array]"},isFunction:function(a){return Object.prototype.toString.apply(a)==="[object Function]"},isDate:function(a){return Object.prototype.toString.apply(a)==="[object Date]"},addEventListener:function(a,b,c){if(a.attachEvent)a.attachEvent("on"+b,c);else if(a.addEventListener)a.addEventListener(b,c,false);else a["on"+b]=c},removeEventListener:function(a,b,c){if(a.detachEvent)a.detachEvent("on"+b,c);else if(a.removeEventListener)a.removeEventListener(b,c,false);else a["on"+b]=null},encodeBase64:function(c){var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[],a=[],b=0,f,d,e,i=c.length;do{f=c[b++];d=c[b++];e=c[b++];a[0]=f>>2;a[1]=(f&3)<<4|d>>4;a[2]=(d&15)<<2|e>>6;a[3]=e&63;if(isNaN(d))a[2]=a[3]=64;else if(isNaN(e))a[3]=64;for(var g=0;g<4;g++)h.push(j.charAt(a[g]))}while(b<i);return h.join("")},getLocalStorage:function(){var a=null;if(!d)try{if(window.localStorage)a=window.localStorage}catch(b){d=true}return a},splitStringToList:function(h,f){for(var c=false,g=-1,e=[],d=false,b=f+h,a=0;a<b.length;a++)if(b[a]=="\\"&&!c)c=true;else{if(b[a]==f&&!d){e.push("");g++}else if(b[a]=='"'&&!c)d=!d;else e[g]+=b[a];c=false}return e},convertIntToHex:function(b){var a="#"+(Number(b)+16777216).toString(16).slice(-6);return a}}}();OSF.OUtil.Guid=function(){var a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{generateNewGuid:function(){for(var c="",d=+new Date,b=0;b<32&&d>0;b++){if(b==8||b==12||b==16||b==20)c+="-";c+=a[d%16];d=Math.floor(d/16)}for(;b<32;b++){if(b==8||b==12||b==16||b==20)c+="-";c+=a[Math.floor(Math.random()*16)]}return c}}}();window.OSF=OSF;OSF.OUtil.setNamespace("OSF",window);OSF.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"};OSF.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"};OSF.AgaveHostAction={Select:0,UnSelect:1};OSF.SharedConstants={NotificationConversationIdSuffix:"_ntf"};OSF.OfficeAppContext=function(p,l,h,g,j,m,i,k,o,d,n,f,e,r,q,c,b,a){this._id=p;this._appName=l;this._appVersion=h;this._appUILocale=g;this._dataLocale=j;this._docUrl=m;this._clientMode=i;this._settings=k;this._reason=o;this._osfControlType=d;this._eToken=n;this._correlationId=f;this._appMinorVersion=c;this._requirementMatrix=b;this._appInstanceId=e;this._isDialog=false;this._dialogRequirementMatrix=a;this.get_id=function(){return this._id};this.get_appName=function(){return this._appName};this.get_appVersion=function(){return this._appVersion};this.get_appUILocale=function(){return this._appUILocale};this.get_dataLocale=function(){return this._dataLocale};this.get_docUrl=function(){return this._docUrl};this.get_clientMode=function(){return this._clientMode};this.get_bindings=function(){return this._bindings};this.get_settings=function(){return this._settings};this.get_reason=function(){return this._reason};this.get_osfControlType=function(){return this._osfControlType};this.get_eToken=function(){return this._eToken};this.get_correlationId=function(){return this._correlationId};this.get_appInstanceId=function(){return this._appInstanceId};this.get_appMinorVersion=function(){return this._appMinorVersion};this.get_requirementMatrix=function(){return this._requirementMatrix};this.get_isDialog=function(){return this._isDialog};this.get_dialogRequirementMatrix=function(){return this._dialogRequirementMatrix}};OSF.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128};OSF.OsfControlType={DocumentLevel:0,ContainerLevel:1};OSF.ClientMode={ReadOnly:0,ReadWrite:1};OSF.OUtil.setNamespace("Microsoft",window);OSF.OUtil.setNamespace("Office",Microsoft);OSF.OUtil.setNamespace("Client",Microsoft.Office);OSF.OUtil.setNamespace("WebExtension",Microsoft.Office);OSF.OUtil.setNamespace("Internal",Microsoft.Office);OSF.NamespaceManager=function(){var b,a=false;return{enableShortcut:function(){if(!a){if(window.Office)b=window.Office;else OSF.OUtil.setNamespace("Office",window);window.Office=Microsoft.Office.WebExtension;a=true}},disableShortcut:function(){if(a){if(b)window.Office=b;else OSF.OUtil.unsetNamespace("Office",window);a=false}}}}();OSF.NamespaceManager.enableShortcut();Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened",Browser:"browser"};Microsoft.Office.WebExtension.ActiveView={Read:"read",Edit:"edit"};Microsoft.Office.WebExtension.ApplicationMode={WebEditor:"webEditor",WebViewer:"webViewer",Client:"client"};Microsoft.Office.WebExtension.DocumentMode={ReadOnly:"readOnly",ReadWrite:"readWrite"};Microsoft.Office.WebExtension.CoercionType={Text:"text",Matrix:"matrix",Table:"table",Image:"image"};Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"};Microsoft.Office.WebExtension.FilterType={All:"all"};Microsoft.Office.WebExtension.PlatformType={PC:"PC",OfficeOnline:"OfficeOnline",Mac:"Mac",iOS:"iOS",Android:"Android",Universal:"Universal"};Microsoft.Office.WebExtension.HostType={Word:"Word",Excel:"Excel",PowerPoint:"PowerPoint",Outlook:"Outlook",OneNote:"OneNote",Project:"Project",Access:"Access"};Microsoft.Office.WebExtension.BindingType={Text:"text",Matrix:"matrix",Table:"table"};Microsoft.Office.WebExtension.GoToType={Binding:"binding",NamedItem:"namedItem",Slide:"slide",Index:"index"};Microsoft.Office.WebExtension.SelectionMode={Default:"default",Selected:"selected",None:"none"};Microsoft.Office.WebExtension.EventType={DocumentSelectionChanged:"documentSelectionChanged",BindingSelectionChanged:"bindingSelectionChanged",BindingDataChanged:"bindingDataChanged",DialogMessageReceived:"dialogMessageReceived",DialogEventReceived:"dialogEventReceived"};Microsoft.Office.Internal.EventType={OfficeThemeChanged:"officeThemeChanged",DocumentThemeChanged:"documentThemeChanged"};Microsoft.Office.WebExtension.AsyncResultStatus={Succeeded:"succeeded",Failed:"failed"};Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Id:"id",GoToType:"goToType",SelectionMode:"selectionMode",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",HostType:"hostType",PlatformType:"platformType",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",Url:"url",MessageHandler:"messageHandler",Width:"width",Height:"height",RequireHTTPs:"requireHTTPS",MessageToParent:"messageToParent",XFrameDenySafe:"xFrameDenySafe"};Microsoft.Office.Internal.Parameters={DocumentTheme:"documentTheme",OfficeTheme:"officeTheme"};Microsoft.Office.WebExtension.DefaultParameterValues={};OSF.OUtil.setNamespace("DDA",OSF);OSF.DDA.DocumentMode={ReadOnly:1,ReadWrite:0};OSF.OUtil.setNamespace("DispIdHost",OSF.DDA);OSF.DDA.DispIdHost.Methods={InvokeMethod:"invokeMethod",AddEventHandler:"addEventHandler",RemoveEventHandler:"removeEventHandler",OpenDialog:"openDialog",CloseDialog:"closeDialog",MessageParent:"messageParent"};OSF.DDA.DispIdHost.Delegates={ExecuteAsync:"executeAsync",RegisterEventAsync:"registerEventAsync",UnregisterEventAsync:"unregisterEventAsync",ParameterMap:"parameterMap",MessageParent:"messageParent"};OSF.OUtil.setNamespace("AsyncResultEnum",OSF.DDA);OSF.DDA.AsyncResultEnum.Properties={Context:"Context",Value:"Value",Status:"Status",Error:"Error"};OSF.DDA.AsyncResultEnum.ErrorProperties={Name:"Name",Message:"Message",Code:"Code"};OSF.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus",FileProperties:"FileProperties",FilePropertiesDescriptor:"FilePropertiesDescriptor",FileSliceProperties:"FileSliceProperties",Subset:"subset",BindingProperties:"BindingProperties",TableDataProperties:"TableDataProperties",DataPartProperties:"DataPartProperties",DataNodeProperties:"DataNodeProperties",MessageType:"messageType",MessageContent:"messageContent"};OSF.DDA.EventDescriptors={BindingSelectionChangedEvent:"BindingSelectionChangedEvent",DataNodeInsertedEvent:"DataNodeInsertedEvent",DataNodeReplacedEvent:"DataNodeReplacedEvent",DataNodeDeletedEvent:"DataNodeDeletedEvent",OfficeThemeChangedEvent:"OfficeThemeChangedEvent",DocumentThemeChangedEvent:"DocumentThemeChangedEvent",ActiveViewChangedEvent:"ActiveViewChangedEvent",AppCommandInvokedEvent:"AppCommandInvokedEvent",DialogMessageReceivedEvent:"DialogMessageReceivedEvent"};OSF.DDA.ListDescriptors={BindingList:"BindingList",DataPartList:"DataPartList",DataNodeList:"DataNodeList"};OSF.DDA.FileProperties={Handle:"FileHandle",FileSize:"FileSize",SliceSize:Microsoft.Office.WebExtension.Parameters.SliceSize};OSF.DDA.FilePropertiesDescriptor={Url:"Url"};OSF.DDA.BindingProperties={Id:"BindingId",Type:Microsoft.Office.WebExtension.Parameters.BindingType,RowCount:"BindingRowCount",ColumnCount:"BindingColumnCount",HasHeaders:"HasHeaders"};OSF.DDA.TableDataProperties={TableRows:"TableRows",TableHeaders:"TableHeaders"};OSF.DDA.DataPartProperties={Id:Microsoft.Office.WebExtension.Parameters.Id,BuiltIn:"DataPartBuiltIn"};OSF.DDA.DataNodeProperties={Handle:"DataNodeHandle",BaseName:"DataNodeBaseName",NamespaceUri:"DataNodeNamespaceUri",NodeType:"DataNodeType"};OSF.DDA.DataNodeEventProperties={OldNode:"OldNode",NewNode:"NewNode",NextSiblingNode:"NextSiblingNode",InUndoRedo:"InUndoRedo"};OSF.DDA.AsyncResultEnum.ErrorCode={Success:0,Failed:1};OSF.DialogMessageType={DialogMessageReceived:0,DialogClosed:12006};OSF.DDA.getXdmEventName=function(b,a){if(a==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||a==Microsoft.Office.WebExtension.EventType.BindingDataChanged)return b+"_"+a;else return a};var __extends=this.__extends||function(b,a){for(var c in a)if(a.hasOwnProperty(c))b[c]=a[c];function d(){this.constructor=b}d.prototype=a.prototype;b.prototype=new d},OfficeExt;(function(a){var b;(function(a){var c=function(){function a(a){this.isSetSupported=function(b,a){if(b==undefined)return false;if(a==undefined)a=0;var e=this._setMap,d=e._sets;if(d.hasOwnProperty(b.toLowerCase())){var c=d[b.toLowerCase()];return c>0&&c>=a}else return false};this._setMap=a}return a}();a.RequirementMatrix=c;var b=function(){function a(a){this._addSetMap=function(a){for(var b in a)this._sets[b]=a[b]};this._sets=a}return a}();a.DefaultSetRequirement=b;var s=function(b){__extends(a,b);function a(){b.call(this,{dialogapi:1.1})}return a}(b);a.DefaultDialogSetRequirement=s;var e=function(b){__extends(a,b);function a(){b.call(this,{bindingevents:1.1,documentevents:1.1,matrixbindings:1.1,matrixcoercion:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1})}return a}(b);a.ExcelClientDefaultSetRequirement=e;var m=function(b){__extends(a,b);function a(){b.call(this);this._addSetMap({imagecoercion:1.1})}return a}(e);a.ExcelClientV2DefaultSetRequirement=m;var n=function(b){__extends(a,b);function a(){b.call(this,{mailbox:1.1})}return a}(b);a.OutlookClientDefaultSetRequirement=n;var j=function(b){__extends(a,b);function a(){b.call(this,{mailbox:1.1})}return a}(b);a.OutlookClientV1DefaultSetRequirement=j;var k=function(b){__extends(a,b);function a(){b.call(this,{mailbox:1.2})}return a}(b);a.OutlookClientV2DefaultSetRequirement=k;var l=function(b){__extends(a,b);function a(){b.call(this,{mailbox:1.3})}return a}(b);a.OutlookClientV3DefaultSetRequirement=l;var f=function(b){__extends(a,b);function a(){b.call(this,{bindingevents:1.1,compressedfile:1.1,customxmlparts:1.1,documentevents:1.1,file:1.1,htmlcoercion:1.1,matrixbindings:1.1,matrixcoercion:1.1,ooxmlcoercion:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1,textfile:1.1})}return a}(b);a.WordClientDefaultSetRequirement=f;var p=function(b){__extends(a,b);function a(){b.call(this);this._addSetMap({imagecoercion:1.1,pdffile:1.1})}return a}(f);a.WordClientV2DefaultSetRequirement=p;var d=function(b){__extends(a,b);function a(){b.call(this,{compressedfile:1.1,documentevents:1.1,file:1.1,selection:1.1,settings:1.1,textcoercion:1.1})}return a}(b);a.PowerpointClientDefaultSetRequirement=d;var i=function(b){__extends(a,b);function a(){b.call(this);this._addSetMap({activeview:1.1,imagecoercion:1.1,pdffile:1.1})}return a}(d);a.PowerpointClientV2DefaultSetRequirement=i;var g=function(b){__extends(a,b);function a(){b.call(this,{selection:1.1,textcoercion:1.1})}return a}(b);a.ProjectClientDefaultSetRequirement=g;var h=function(b){__extends(a,b);function a(){b.call(this,{bindingevents:1.1,documentevents:1.1,matrixbindings:1.1,matrixcoercion:1.1,selection:1.1,settings:1.1,tablebindings:1.1,tablecoercion:1.1,textbindings:1.1,textcoercion:1.1,file:1.1})}return a}(b);a.ExcelWebDefaultSetRequirement=h;var q=function(b){__extends(a,b);function a(){b.call(this);this._addSetMap({activeview:1.1})}return a}(h);a.ExcelWebV2DefaultSetRequirement=q;var r=function(b){__extends(a,b);function a(){b.call(this,{mailbox:1.1})}return a}(b);a.OutlookWebDefaultSetRequirement=r;var o=function(b){__extends(a,b);function a(){b.call(this,{mailbox:1.3})}return a}(b);a.OutlookWebV1DefaultSetRequirement=o;var t=function(){function a(){}a.initializeOsfDda=function(){OSF.OUtil.setNamespace("Requirement",OSF.DDA)};a.getDefaultRequirementMatrix=function(e){this.initializeDefaultSetMatrix();var d=undefined,f=e.get_requirementMatrix();if(f!=undefined&&f.length>0&&typeof JSON!=="undefined"){var i=JSON.parse(e.get_requirementMatrix().toLowerCase());d=new c(new b(i))}else{var h=e.get_appVersion(),g=e.get_appName()+"-"+h;if(a.DefaultSetArrayMatrix!=undefined&&a.DefaultSetArrayMatrix[g]!=undefined)d=new c(a.DefaultSetArrayMatrix[g]);else d=new c(new b({}))}return d};a.getDialogDefaultRequirementMatrix=function(e){var a=undefined,d=e.get_dialogRequirementMatrix();if(d!=undefined&&d.length>0&&typeof JSON!=="undefined"){var f=JSON.parse(e.get_requirementMatrix().toLowerCase());a=new c(new b(f))}else a=new c(new s);return a};a.initializeDefaultSetMatrix=function(){a.DefaultSetArrayMatrix[a.Excel_RCLIENT_1500]=new e;a.DefaultSetArrayMatrix[a.Excel_RCLIENT_1501]=new e;a.DefaultSetArrayMatrix[a.Excel_RCLIENT_1502]=new m;a.DefaultSetArrayMatrix[a.Word_RCLIENT_1500]=new f;a.DefaultSetArrayMatrix[a.Word_RCLIENT_1501]=new f;a.DefaultSetArrayMatrix[a.Word_RCLIENT_1502]=new p;a.DefaultSetArrayMatrix[a.PowerPoint_RCLIENT_1500]=new d;a.DefaultSetArrayMatrix[a.PowerPoint_RCLIENT_1501]=new d;a.DefaultSetArrayMatrix[a.PowerPoint_RCLIENT_1502]=new i;a.DefaultSetArrayMatrix[a.Outlook_RCLIENT_1500]=new n;a.DefaultSetArrayMatrix[a.Outlook_RCLIENT_1501]=new j;a.DefaultSetArrayMatrix[a.Outlook_RCLIENT_1502]=new k;a.DefaultSetArrayMatrix[a.Outlook_RCLIENT_1503]=new l;a.DefaultSetArrayMatrix[a.Excel_WAC_1500]=new h;a.DefaultSetArrayMatrix[a.Excel_WAC_1501]=new h;a.DefaultSetArrayMatrix[a.Excel_WAC_1502]=new q;a.DefaultSetArrayMatrix[a.Outlook_WAC_1500]=new r;a.DefaultSetArrayMatrix[a.Outlook_WAC_1501]=new o;a.DefaultSetArrayMatrix[a.Project_RCLIENT_1500]=new g;a.DefaultSetArrayMatrix[a.Project_RCLIENT_1501]=new g;a.DefaultSetArrayMatrix[a.Project_RCLIENT_1502]=new g;a.DefaultSetArrayMatrix[a.Excel_IOS_1500]=new e;a.DefaultSetArrayMatrix[a.Word_IOS_1500]=new f;a.DefaultSetArrayMatrix[a.PowerPoint_IOS_1500]=new d};a.Excel_RCLIENT_1500="1-15.00";a.Excel_RCLIENT_1501="1-15.01";a.Excel_RCLIENT_1502="1-15.02";a.Word_RCLIENT_1500="2-15.00";a.Word_RCLIENT_1501="2-15.01";a.Word_RCLIENT_1502="2-15.02";a.PowerPoint_RCLIENT_1500="4-15.00";a.PowerPoint_RCLIENT_1501="4-15.01";a.PowerPoint_RCLIENT_1502="4-15.02";a.Outlook_RCLIENT_1500="8-15.00";a.Outlook_RCLIENT_1501="8-15.01";a.Outlook_RCLIENT_1502="8-15.02";a.Outlook_RCLIENT_1503="8-15.03";a.Excel_WAC_1500="16-15.00";a.Excel_WAC_1501="16-15.01";a.Excel_WAC_1502="16-15.02";a.Outlook_WAC_1500="64-15.00";a.Outlook_WAC_1501="64-15.01";a.Project_RCLIENT_1500="128-15.00";a.Project_RCLIENT_1501="128-15.01";a.Project_RCLIENT_1502="128-15.02";a.Excel_IOS_1500="1024-15.00";a.Word_IOS_1500="4096-15.00";a.PowerPoint_IOS_1500="8192-15.00";a.DefaultSetArrayMatrix={};return a}();a.RequirementsMatrixFactory=t})(b=a.Requirement||(a.Requirement={}))})(OfficeExt||(OfficeExt={}));OfficeExt.Requirement.RequirementsMatrixFactory.initializeOsfDda();var OfficeExt;(function(a){var b;(function(a){var b=function(){function a(){this.getHost=function(c){var a=this.getFullHost(c);if(a){for(var d in this.platformPossibilities){var b=a.indexOf(d);if(b>=0){a=a.substring(0,b);return Microsoft.Office.WebExtension.HostType[a]||null}}return Microsoft.Office.WebExtension.HostType[a]||null}return null};this.getDiagnostics=function(a){var b={host:this.getHost(a),version:"15.0.0000.0000",platform:this.getPlatform(a)};return b};this.platformPossibilities={WebApp:Microsoft.Office.WebExtension.PlatformType.OfficeOnline,Unsupported:null};this.getHost=this.getHost.bind(this);this.getDiagnostics=this.getDiagnostics.bind(this)}a.getInstance=function(){if(a.hostObj===undefined)a.hostObj=new a;return a.hostObj};a.prototype.getPlatform=function(c){var a=this.getFullHost(c);if(a===null)return null;var d=Microsoft.Office.WebExtension.PlatformType.PC;for(var b in this.platformPossibilities)if(a.indexOf(b)>=0)return this.platformPossibilities[b];return d};a.prototype.getFullHost=function(c){var a=null;for(var b in OSF.AppName)if(OSF.AppName[b]===c){a=b;break}return a};return a}();a.Host=b})(b=a.HostName||(a.HostName={}))})(OfficeExt||(OfficeExt={}));OSF.DDA.ErrorCodeManager=function(){var a={};return{getErrorArgs:function(b){return a[b]||a[this.errorCodes.ooeInternalError]},addErrorMessage:function(c,b){a[c]=b},errorCodes:{ooeSuccess:0,ooeCoercionTypeNotSupported:1e3,ooeGetSelectionNotMatchDataType:1001,ooeCoercionTypeNotMatchBinding:1002,ooeInvalidGetRowColumnCounts:1003,ooeSelectionNotSupportCoercionType:1004,ooeInvalidGetStartRowColumn:1005,ooeNonUniformPartialGetNotSupported:1006,ooeGetDataIsTooLarge:1008,ooeFileTypeNotSupported:1009,ooeUnsupportedDataObject:2e3,ooeCannotWriteToSelection:2001,ooeDataNotMatchSelection:2002,ooeOverwriteWorksheetData:2003,ooeDataNotMatchBindingSize:2004,ooeInvalidSetStartRowColumn:2005,ooeInvalidDataFormat:2006,ooeDataNotMatchCoercionType:2007,ooeDataNotMatchBindingType:2008,ooeSetDataIsTooLarge:2009,ooeNonUniformPartialSetNotSupported:2010,ooeSelectionCannotBound:3e3,ooeBindingNotExist:3002,ooeBindingToMultipleSelection:3003,ooeInvalidSelectionForBindingType:3004,ooeOperationNotSupportedOnThisBindingType:3005,ooeNamedItemNotFound:3006,ooeMultipleNamedItemFound:3007,ooeInvalidNamedItemForBindingType:3008,ooeUnknownBindingType:3009,ooeOperationNotSupportedOnMatrixData:3010,ooeSettingNameNotExist:4e3,ooeSettingsCannotSave:4001,ooeSettingsAreStale:4002,ooeOperationNotSupported:5e3,ooeInternalError:5001,ooeDocumentReadOnly:5002,ooeEventHandlerNotExist:5003,ooeInvalidApiCallInContext:5004,ooeShuttingDown:5005,ooeUnsupportedEnumeration:5007,ooeIndexOutOfRange:5008,ooeCustomXmlNodeNotFound:6e3,ooeCustomXmlError:6100,ooeNoCapability:7e3,ooeCannotNavTo:7001,ooeSpecifiedIdNotExist:7002,ooeNavOutOfBound:7004,ooeElementMissing:8e3,ooeProtectedError:8001,ooeInvalidCellsValue:8010,ooeInvalidTableOptionValue:8011,ooeInvalidFormatValue:8012,ooeRowIndexOutOfRange:8020,ooeColIndexOutOfRange:8021,ooeFormatValueOutOfRange:8022},initializeErrorMessages:function(b){a[OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported]={name:b.L_InvalidCoercion,message:b.L_CoercionTypeNotSupported};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType]={name:b.L_DataReadError,message:b.L_GetSelectionNotSupported};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding]={name:b.L_InvalidCoercion,message:b.L_CoercionTypeNotMatchBinding};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetRowColumnCounts]={name:b.L_DataReadError,message:b.L_InvalidGetRowColumnCounts};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeSelectionNotSupportCoercionType]={name:b.L_DataReadError,message:b.L_SelectionNotSupportCoercionType};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidGetStartRowColumn]={name:b.L_DataReadError,message:b.L_InvalidGetStartRowColumn};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialGetNotSupported]={name:b.L_DataReadError,message:b.L_NonUniformPartialGetNotSupported};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeGetDataIsTooLarge]={name:b.L_DataReadError,message:b.L_GetDataIsTooLarge};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported]={name:b.L_DataReadError,message:b.L_FileTypeNotSupported};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedDataObject]={name:b.L_DataWriteError,message:b.L_UnsupportedDataObject};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection]={name:b.L_DataWriteError,message:b.L_CannotWriteToSelection};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchSelection]={name:b.L_DataWriteError,message:b.L_DataNotMatchSelection};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeOverwriteWorksheetData]={name:b.L_DataWriteError,message:b.L_OverwriteWorksheetData};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingSize]={name:b.L_DataWriteError,message:b.L_DataNotMatchBindingSize};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSetStartRowColumn]={name:b.L_DataWriteError,message:b.L_InvalidSetStartRowColumn};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidDataFormat]={name:b.L_InvalidFormat,message:b.L_InvalidDataFormat};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchCoercionType]={name:b.L_InvalidDataObject,message:b.L_DataNotMatchCoercionType};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeDataNotMatchBindingType]={name:b.L_InvalidDataObject,message:b.L_DataNotMatchBindingType};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge]={name:b.L_DataWriteError,message:b.L_SetDataIsTooLarge};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeNonUniformPartialSetNotSupported]={name:b.L_DataWriteError,message:b.L_NonUniformPartialSetNotSupported};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeSelectionCannotBound]={name:b.L_BindingCreationError,message:b.L_SelectionCannotBound};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingNotExist]={name:b.L_InvalidBindingError,message:b.L_BindingNotExist};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeBindingToMultipleSelection]={name:b.L_BindingCreationError,message:b.L_BindingToMultipleSelection};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSelectionForBindingType]={name:b.L_BindingCreationError,message:b.L_InvalidSelectionForBindingType};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnThisBindingType]={name:b.L_InvalidBindingOperation,message:b.L_OperationNotSupportedOnThisBindingType};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeNamedItemNotFound]={name:b.L_BindingCreationError,message:b.L_NamedItemNotFound};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeMultipleNamedItemFound]={name:b.L_BindingCreationError,message:b.L_MultipleNamedItemFound};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidNamedItemForBindingType]={name:b.L_BindingCreationError,message:b.L_InvalidNamedItemForBindingType};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeUnknownBindingType]={name:b.L_InvalidBinding,message:b.L_UnknownBindingType};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupportedOnMatrixData]={name:b.L_InvalidBindingOperation,message:b.L_OperationNotSupportedOnMatrixData};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeSettingNameNotExist]={name:b.L_ReadSettingsError,message:b.L_SettingNameNotExist};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeSettingsCannotSave]={name:b.L_SaveSettingsError,message:b.L_SettingsCannotSave};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeSettingsAreStale]={name:b.L_SettingsStaleError,message:b.L_SettingsAreStale};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationNotSupported]={name:b.L_HostError,message:b.L_OperationNotSupported};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError]={name:b.L_InternalError,message:b.L_InternalErrorDescription};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeDocumentReadOnly]={name:b.L_PermissionDenied,message:b.L_DocumentReadOnly};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeEventHandlerNotExist]={name:b.L_EventRegistrationError,message:b.L_EventHandlerNotExist};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext]={name:b.L_InvalidAPICall,message:b.L_InvalidApiCallInContext};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeShuttingDown]={name:b.L_ShuttingDown,message:b.L_ShuttingDown};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration]={name:b.L_UnsupportedEnumeration,message:b.L_UnsupportedEnumerationMessage};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange]={name:b.L_IndexOutOfRange,message:b.L_IndexOutOfRange};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlNodeNotFound]={name:b.L_InvalidNode,message:b.L_CustomXmlNodeNotFound};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeCustomXmlError]={name:b.L_CustomXmlError,message:b.L_CustomXmlError};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeNoCapability]={name:b.L_PermissionDenied,message:b.L_NoCapability};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo]={name:b.L_CannotNavigateTo,message:b.L_CannotNavigateTo};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist]={name:b.L_SpecifiedIdNotExist,message:b.L_SpecifiedIdNotExist};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound]={name:b.L_NavOutOfBound,message:b.L_NavOutOfBound};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeElementMissing]={name:b.L_MissingParameter,message:b.L_ElementMissing};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeProtectedError]={name:b.L_PermissionDenied,message:b.L_NoCapability};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidCellsValue]={name:b.L_InvalidValue,message:b.L_InvalidCellsValue};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidTableOptionValue]={name:b.L_InvalidValue,message:b.L_InvalidTableOptionValue};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidFormatValue]={name:b.L_InvalidValue,message:b.L_InvalidFormatValue};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeRowIndexOutOfRange]={name:b.L_OutOfRange,message:b.L_RowIndexOutOfRange};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeColIndexOutOfRange]={name:b.L_OutOfRange,message:b.L_ColIndexOutOfRange};a[OSF.DDA.ErrorCodeManager.errorCodes.ooeFormatValueOutOfRange]={name:b.L_OutOfRange,message:b.L_FormatValueOutOfRange}}}}();OSF.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMethodMax:143,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117};OSF.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidDialogMessageReceivedEvent:10,dispidAppCommandInvokedEvent:39,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58};OSF.OUtil.setNamespace("Microsoft",window);OSF.OUtil.setNamespace("Office",Microsoft);OSF.OUtil.setNamespace("Common",Microsoft.Office);Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5};Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6};Microsoft.Office.Common.MessageType={request:0,response:1};Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2};Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1};Microsoft.Office.Common.MethodObject=function(c,b,a){this._method=c;this._invokeType=b;this._blockingOthers=a};Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}};Microsoft.Office.Common.EventMethodObject=function(b,a){this._registerMethodObject=b;this._unregisterMethodObject=a};Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}};Microsoft.Office.Common.ServiceEndPoint=function(b){var a=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:false}]);if(a)throw a;this._methodObjectList={};this._eventHandlerProxyList={};this._Id=b;this._conversations={};this._policyManager=null};Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(e,f,a,c){var b=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:false},{name:"method",type:Function,mayBeNull:false},{name:"invokeType",type:Number,mayBeNull:false},{name:"blockingOthers",type:Boolean,mayBeNull:false}]);if(b)throw b;if(a!==Microsoft.Office.Common.InvokeType.async&&a!==Microsoft.Office.Common.InvokeType.sync)throw OsfMsAjaxFactory.msAjaxError.argument("invokeType");var d=new Microsoft.Office.Common.MethodObject(f,a,c);this._methodObjectList[e]=d},unregisterMethod:function(b){var a=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:false}]);if(a)throw a;delete this._methodObjectList[b]},registerEvent:function(e,c,b){var a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:false},{name:"registerMethod",type:Function,mayBeNull:false},{name:"unregisterMethod",type:Function,mayBeNull:false}]);if(a)throw a;var d=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(c,Microsoft.Office.Common.InvokeType.syncRegisterEvent,false),new Microsoft.Office.Common.MethodObject(b,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,false));this._methodObjectList[e]=d},registerEventEx:function(g,e,c,d,b){var a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:false},{name:"registerMethod",type:Function,mayBeNull:false},{name:"registerMethodInvokeType",type:Number,mayBeNull:false},{name:"unregisterMethod",type:Function,mayBeNull:false},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:false}]);if(a)throw a;var f=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(e,c,false),new Microsoft.Office.Common.MethodObject(d,b,false));this._methodObjectList[g]=f},unregisterEvent:function(b){var a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:false}]);if(a)throw a;this.unregisterMethod(b)},registerConversation:function(b){var a=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false}]);if(a)throw a;this._conversations[b]=true},unregisterConversation:function(b){var a=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false}]);if(a)throw a;delete this._conversations[b]},setPolicyManager:function(a){var b=Function._validateParams(arguments,[{name:"policyManager",type:Object,mayBeNull:false}]);if(b)throw b;if(!a.checkPermission)throw OsfMsAjaxFactory.msAjaxError.argument("policyManager");this._policyManager=a},getPolicyManager:function(){return this._policyManager}};Microsoft.Office.Common.ClientEndPoint=function(c,a,d){var b=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false},{name:"targetWindow",mayBeNull:false},{name:"targetUrl",type:String,mayBeNull:false}]);if(b)throw b;if(!a.postMessage)throw OsfMsAjaxFactory.msAjaxError.argument("targetWindow");this._conversationId=c;this._targetWindow=a;this._targetUrl=d;this._callingIndex=0;this._callbackList={};this._eventHandlerList={}};Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(f,c,a){var e=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"param",mayBeNull:true}]);if(e)throw e;var b=this._callingIndex++,i=new Date,d={callback:c,createdOn:i.getTime()};if(a&&typeof a==="object"&&typeof a.__timeout__==="number"){d.timeout=a.__timeout__;delete a.__timeout__}this._callbackList[b]=d;try{var g=new Microsoft.Office.Common.Request(f,Microsoft.Office.Common.ActionType.invoke,this._conversationId,b,a),h=Microsoft.Office.Common.MessagePackager.envelope(g);this._targetWindow.postMessage(h,this._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(j){try{c!==null&&c(Microsoft.Office.Common.InvokeResultCode.errorInRequest,j)}finally{delete this._callbackList[b]}}},registerForEvent:function(c,e,b,g){var d=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:false},{name:"eventHandler",type:Function,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"data",mayBeNull:true,optional:true}]);if(d)throw d;var a=this._callingIndex++,i=new Date;this._callbackList[a]={callback:b,createdOn:i.getTime()};try{var f=new Microsoft.Office.Common.Request(c,Microsoft.Office.Common.ActionType.registerEvent,this._conversationId,a,g),h=Microsoft.Office.Common.MessagePackager.envelope(f);this._targetWindow.postMessage(h,this._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer();this._eventHandlerList[c]=e}catch(j){try{b!==null&&b(Microsoft.Office.Common.InvokeResultCode.errorInRequest,j)}finally{delete this._callbackList[a]}}},unregisterForEvent:function(c,b,f){var d=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"data",mayBeNull:true,optional:true}]);if(d)throw d;var a=this._callingIndex++,h=new Date;this._callbackList[a]={callback:b,createdOn:h.getTime()};try{var e=new Microsoft.Office.Common.Request(c,Microsoft.Office.Common.ActionType.unregisterEvent,this._conversationId,a,f),g=Microsoft.Office.Common.MessagePackager.envelope(e);this._targetWindow.postMessage(g,this._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(i){try{b!==null&&b(Microsoft.Office.Common.InvokeResultCode.errorInRequest,i)}finally{delete this._callbackList[a]}}finally{delete this._eventHandlerList[c]}}};Microsoft.Office.Common.XdmCommunicationManager=function(){var f=[],b=null,q=10,e=false,c=null,j=2e3,g=6e4,d={},a={},h=false;function k(b){for(var a in d)if(d[a]._conversations[b])return d[a];OsfMsAjaxFactory.msAjaxDebug.trace("Unknown conversation Id.");throw OsfMsAjaxFactory.msAjaxError.argument("conversationId");}function l(c){var b=a[c];if(!b){OsfMsAjaxFactory.msAjaxDebug.trace("Unknown conversation Id.");throw OsfMsAjaxFactory.msAjaxError.argument("conversationId");}return b}function o(d,b){var a=d._methodObjectList[b._actionName];if(!a){OsfMsAjaxFactory.msAjaxDebug.trace("The specified method is not registered on service endpoint:"+b._actionName);throw OsfMsAjaxFactory.msAjaxError.argument("messageObject");}var c=null;if(b._actionType===Microsoft.Office.Common.ActionType.invoke)c=a;else if(b._actionType===Microsoft.Office.Common.ActionType.registerEvent)c=a.getRegisterMethodObject();else c=a.getUnregisterMethodObject();return c}function s(a){f.push(a)}function r(){if(b!==null){if(!e)if(f.length>0){var a=f.shift();e=a.getInvokeBlockingFlag();a.invoke()}else{clearInterval(b);b=null}}else OsfMsAjaxFactory.msAjaxDebug.trace("channel is not ready.")}function n(){if(c){var d,e=0,j=new Date,h;for(var i in a){d=a[i];for(var f in d._callbackList){var b=d._callbackList[f];h=b.timeout?b.timeout:g;if(Math.abs(j.getTime()-b.createdOn)>=h)try{b.callback&&b.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,null)}finally{delete d._callbackList[f]}else e++}}if(e===0){clearInterval(c);c=null}}else OsfMsAjaxFactory.msAjaxDebug.trace("channel is not ready.")}function m(){e=false}function p(a){if(window.addEventListener)window.addEventListener("message",a,false);else if(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent)window.attachEvent("onmessage",a);else{OsfMsAjaxFactory.msAjaxDebug.trace("Browser doesn't support the required API.");throw OsfMsAjaxFactory.msAjaxError.argument("Browser");}}function t(c){if(c.data!=""){var a;try{a=Microsoft.Office.Common.MessagePackager.unenvelope(c.data)}catch(w){return}if(typeof a._messageType=="undefined")return;if(a._messageType===Microsoft.Office.Common.MessageType.request){var i=c.origin==null||c.origin=="null"?a._origin:c.origin;try{var d=k(a._conversationId),h=d.getPolicyManager();if(h&&!h.checkPermission(a._conversationId,a._actionName,a._data))throw"Access Denied";var u=o(d,a),n=new Microsoft.Office.Common.InvokeCompleteCallback(c.source,i,a._actionName,a._conversationId,a._correlationId,m),v=new Microsoft.Office.Common.Invoker(u,a._data,n,d._eventHandlerProxyList,a._conversationId,a._actionName);if(b==null)b=setInterval(r,q);s(v)}catch(w){var j=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;if(w=="Access Denied")j=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied;var t=new Microsoft.Office.Common.Response(a._actionName,a._conversationId,a._correlationId,j,Microsoft.Office.Common.ResponseType.forCalling,w),p=Microsoft.Office.Common.MessagePackager.envelope(t);c.source&&c.source.postMessage&&c.source.postMessage(p,i)}}else if(a._messageType===Microsoft.Office.Common.MessageType.response){var e=l(a._conversationId);if(a._responseType===Microsoft.Office.Common.ResponseType.forCalling){var f=e._callbackList[a._correlationId];if(f)try{f.callback&&f.callback(a._errorCode,a._data)}finally{delete e._callbackList[a._correlationId]}}else{var g=e._eventHandlerList[a._actionName];g!==undefined&&g!==null&&g(a._data)}}else return}}function i(){if(!h){p(t);h=true}}return{connect:function(c,d,e){var b=a[c];if(!b){i();b=new Microsoft.Office.Common.ClientEndPoint(c,d,e);a[c]=b}return b},getClientEndPoint:function(c){var b=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false}]);if(b)throw b;return a[c]},createServiceEndPoint:function(a){i();var b=new Microsoft.Office.Common.ServiceEndPoint(a);d[a]=b;return b},getServiceEndPoint:function(b){var a=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:false}]);if(a)throw a;return d[b]},deleteClientEndPoint:function(c){var b=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false}]);if(b)throw b;delete a[c]},_setMethodTimeout:function(a){var b=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:false}]);if(b)throw b;g=a<=0?6e4:a},_startMethodTimeoutTimer:function(){if(!c)c=setInterval(n,j)}}}();Microsoft.Office.Common.Message=function(e,f,c,d,a){var b=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:false},{name:"actionName",type:String,mayBeNull:false},{name:"conversationId",type:String,mayBeNull:false},{name:"correlationId",mayBeNull:false},{name:"data",mayBeNull:true,optional:true}]);if(b)throw b;this._messageType=e;this._actionName=f;this._conversationId=c;this._correlationId=d;this._origin=window.location.href;if(typeof a=="undefined")this._data=null;else this._data=a};Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}};Microsoft.Office.Common.Request=function(c,d,a,b,e){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,c,a,b,e);this._actionType=d};OSF.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message);Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType};Microsoft.Office.Common.Response=function(d,a,b,e,c,f){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,d,a,b,f);this._errorCode=e;this._responseType=c};OSF.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message);Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode};Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType};Microsoft.Office.Common.MessagePackager={envelope:function(a){return OsfMsAjaxFactory.msAjaxSerializer.serialize(a)},unenvelope:function(a){return OsfMsAjaxFactory.msAjaxSerializer.deserialize(a,true)}};Microsoft.Office.Common.ResponseSender=function(c,f,h,d,e,g){var b=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:false},{name:"requesterUrl",type:String,mayBeNull:false},{name:"actionName",type:String,mayBeNull:false},{name:"conversationId",type:String,mayBeNull:false},{name:"correlationId",mayBeNull:false},{name:"responsetype",type:Number,maybeNull:false}]);if(b)throw b;this._requesterWindow=c;this._requesterUrl=f;this._actionName=h;this._conversationId=d;this._correlationId=e;this._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError;this._responseType=g;var a=this;this._send=function(d){var c=new Microsoft.Office.Common.Response(a._actionName,a._conversationId,a._correlationId,a._invokeResultCode,a._responseType,d),b=Microsoft.Office.Common.MessagePackager.envelope(c);a._requesterWindow.postMessage(b,a._requesterUrl)}};Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(a){this._invokeResultCode=a}};Microsoft.Office.Common.InvokeCompleteCallback=function(c,f,g,d,e,b){Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(this,c,f,g,d,e,Microsoft.Office.Common.ResponseType.forCalling);this._postCallbackHandler=b;var a=this;this._send=function(d){var c=new Microsoft.Office.Common.Response(a._actionName,a._conversationId,a._correlationId,a._invokeResultCode,a._responseType,d),b=Microsoft.Office.Common.MessagePackager.envelope(c);a._requesterWindow.postMessage(b,a._requesterUrl);a._postCallbackHandler()}};OSF.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender);Microsoft.Office.Common.Invoker=function(e,f,b,c,d,g){var a=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:false},{name:"paramValue",mayBeNull:true},{name:"invokeCompleteCallback",mayBeNull:false},{name:"eventHandlerProxyList",mayBeNull:true},{name:"conversationId",type:String,mayBeNull:false},{name:"eventName",type:String,mayBeNull:false}]);if(a)throw a;this._methodObject=e;this._param=f;this._invokeCompleteCallback=b;this._eventHandlerProxyList=c;this._conversationId=d;this._eventName=g};Microsoft.Office.Common.Invoker.prototype={invoke:function(){try{var a;switch(this._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:this._methodObject.getMethod()(this._param,this._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:a=this._methodObject.getMethod()(this._param);this._invokeCompleteCallback.getSend()(a);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var c=this._createEventHandlerProxyObject(this._invokeCompleteCallback);a=this._methodObject.getMethod()(c.getSend(),this._param);this._eventHandlerProxyList[this._conversationId+this._eventName]=c.getSend();this._invokeCompleteCallback.getSend()(a);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var e=this._eventHandlerProxyList[this._conversationId+this._eventName];a=this._methodObject.getMethod()(e,this._param);delete this._eventHandlerProxyList[this._conversationId+this._eventName];this._invokeCompleteCallback.getSend()(a);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var b=this._createEventHandlerProxyObject(this._invokeCompleteCallback);this._methodObject.getMethod()(b.getSend(),this._invokeCompleteCallback.getSend(),this._param);this._eventHandlerProxyList[this._callerId+this._eventName]=b.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var d=this._eventHandlerProxyList[this._callerId+this._eventName];this._methodObject.getMethod()(d,this._invokeCompleteCallback.getSend(),this._param);delete this._eventHandlerProxyList[this._callerId+this._eventName];break;default:break}}catch(f){this._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse);this._invokeCompleteCallback.getSend()(f)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(a){return new Microsoft.Office.Common.ResponseSender(a.getRequesterWindow(),a.getRequesterUrl(),a.getActionName(),a.getConversationId(),a.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing)}};OSF.EventDispatch=function(a){this._eventHandlers={};this._queuedEventsArgs={};for(var c in a){var b=a[c];this._eventHandlers[b]=[];this._queuedEventsArgs[b]=[]}};OSF.EventDispatch.prototype={getSupportedEvents:function(){var a=[];for(var b in this._eventHandlers)a.push(b);return a},supportsEvent:function(c){var a=false;for(var b in this._eventHandlers)if(c==b){a=true;break}return a},hasEventHandler:function(b,c){var a=this._eventHandlers[b];if(a&&a.length>0)for(var d in a)if(a[d]===c)return true;return false},addEventHandler:function(b,a){if(typeof a!="function")return false;var c=this._eventHandlers[b];if(c&&!this.hasEventHandler(b,a)){c.push(a);return true}else return false},addEventHandlerAndFireQueuedEvent:function(a,e){var d=this._eventHandlers[a],c=d.length==0,b=this.addEventHandler(a,e);c&&b&&this.fireQueuedEvent(a);return b},removeEventHandler:function(c,d){var a=this._eventHandlers[c];if(a&&a.length>0)for(var b=0;b<a.length;b++)if(a[b]===d){a.splice(b,1);return true}return false},clearEventHandlers:function(a){this._eventHandlers[a]=[]},getEventHandlerCount:function(a){return this._eventHandlers[a]!=undefined?this._eventHandlers[a].length:-1},fireEvent:function(a){if(a.type==undefined)return false;var b=a.type;if(b&&this._eventHandlers[b]){var c=this._eventHandlers[b];for(var d in c)c[d](a);return true}else return false},fireOrQueueEvent:function(b){var a=b.type;if(a&&this._eventHandlers[a]){var c=this._eventHandlers[a],d=this._queuedEventsArgs[a];if(c.length==0)d.push(b);else this.fireEvent(b);return true}else return false},fireQueuedEvent:function(a){if(a&&this._eventHandlers[a]){var b=this._eventHandlers[a],c=this._queuedEventsArgs[a];if(b.length>0){var d=b[0];while(c.length>0){var e=c.shift();d(e)}return true}}return false}};OSF.DDA.DataCoercion=function(){return{findArrayDimensionality:function(c){if(OSF.OUtil.isArray(c)){for(var b=0,a=0;a<c.length;a++)b=Math.max(b,OSF.DDA.DataCoercion.findArrayDimensionality(c[a]));return b+1}else return 0},getCoercionDefaultForBinding:function(a){switch(a){case Microsoft.Office.WebExtension.BindingType.Matrix:return Microsoft.Office.WebExtension.CoercionType.Matrix;case Microsoft.Office.WebExtension.BindingType.Table:return Microsoft.Office.WebExtension.CoercionType.Table;case Microsoft.Office.WebExtension.BindingType.Text:default:return Microsoft.Office.WebExtension.CoercionType.Text}},getBindingDefaultForCoercion:function(a){switch(a){case Microsoft.Office.WebExtension.CoercionType.Matrix:return Microsoft.Office.WebExtension.BindingType.Matrix;case Microsoft.Office.WebExtension.CoercionType.Table:return Microsoft.Office.WebExtension.BindingType.Table;case Microsoft.Office.WebExtension.CoercionType.Text:case Microsoft.Office.WebExtension.CoercionType.Html:case Microsoft.Office.WebExtension.CoercionType.Ooxml:default:return Microsoft.Office.WebExtension.BindingType.Text}},determineCoercionType:function(a){if(a==null||a==undefined)return null;var b=null,c=typeof a;if(a.rows!==undefined)b=Microsoft.Office.WebExtension.CoercionType.Table;else if(OSF.OUtil.isArray(a))b=Microsoft.Office.WebExtension.CoercionType.Matrix;else if(c=="string"||c=="number"||c=="boolean"||OSF.OUtil.isDate(a))b=Microsoft.Office.WebExtension.CoercionType.Text;else throw OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedDataObject;return b},coerceData:function(b,c,a){a=a||OSF.DDA.DataCoercion.determineCoercionType(b);if(a&&a!=c){OSF.OUtil.writeProfilerMark(OSF.InternalPerfMarker.DataCoercionBegin);b=OSF.DDA.DataCoercion._coerceDataFromTable(c,OSF.DDA.DataCoercion._coerceDataToTable(b,a));OSF.OUtil.writeProfilerMark(OSF.InternalPerfMarker.DataCoercionEnd)}return b},_matrixToText:function(a){if(a.length==1&&a[0].length==1)return""+a[0][0];for(var b="",c=0;c<a.length;c++)b+=a[c].join("\t")+"\n";return b.substring(0,b.length-1)},_textToMatrix:function(c){for(var a=c.split("\n"),b=0;b<a.length;b++)a[b]=a[b].split("\t");return a},_tableToText:function(b){var a="";if(b.headers!=null)a=OSF.DDA.DataCoercion._matrixToText([b.headers])+"\n";var c=OSF.DDA.DataCoercion._matrixToText(b.rows);if(c=="")a=a.substring(0,a.length-1);return a+c},_tableToMatrix:function(a){var b=a.rows;a.headers!=null&&b.unshift(a.headers);return b},_coerceDataFromTable:function(c,b){var a;switch(c){case Microsoft.Office.WebExtension.CoercionType.Table:a=b;break;case Microsoft.Office.WebExtension.CoercionType.Matrix:a=OSF.DDA.DataCoercion._tableToMatrix(b);break;case Microsoft.Office.WebExtension.CoercionType.SlideRange:try{var d=OSF.DDA.DataCoercion._tableToText(b);a=new OSF.DDA.SlideRange(d)}catch(e){a=OSF.DDA.DataCoercion._tableToText(b)}break;case Microsoft.Office.WebExtension.CoercionType.Text:case Microsoft.Office.WebExtension.CoercionType.Html:case Microsoft.Office.WebExtension.CoercionType.Ooxml:default:a=OSF.DDA.DataCoercion._tableToText(b);break}return a},_coerceDataToTable:function(b,c){if(c==undefined)c=OSF.DDA.DataCoercion.determineCoercionType(b);var a;switch(c){case Microsoft.Office.WebExtension.CoercionType.Table:a=b;break;case Microsoft.Office.WebExtension.CoercionType.Matrix:a=new Microsoft.Office.WebExtension.TableData(b);break;case Microsoft.Office.WebExtension.CoercionType.Text:case Microsoft.Office.WebExtension.CoercionType.Html:case Microsoft.Office.WebExtension.CoercionType.Ooxml:default:a=new Microsoft.Office.WebExtension.TableData(OSF.DDA.DataCoercion._textToMatrix(b));break}return a}}}();OSF.DDA.issueAsyncResult=function(d,f,a){var e=d[Microsoft.Office.WebExtension.Parameters.Callback];if(e){var c={};c[OSF.DDA.AsyncResultEnum.Properties.Context]=d[Microsoft.Office.WebExtension.Parameters.AsyncContext];var b;if(f==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)c[OSF.DDA.AsyncResultEnum.Properties.Value]=a;else{b={};a=a||OSF.DDA.ErrorCodeManager.getErrorArgs(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);b[OSF.DDA.AsyncResultEnum.ErrorProperties.Code]=f||OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;b[OSF.DDA.AsyncResultEnum.ErrorProperties.Name]=a.name||a;b[OSF.DDA.AsyncResultEnum.ErrorProperties.Message]=a.message||a}e(new OSF.DDA.AsyncResult(c,b))}};OSF.DDA.generateBindingId=function(){return"UnnamedBinding_"+OSF.OUtil.getUniqueId()+"_"+ +new Date};OSF.DDA.SettingsManager={SerializedSettings:"serializedSettings",DateJSONPrefix:"Date(",DataJSONSuffix:")",serializeSettings:function(b){var d={};for(var c in b){var a=b[c];try{if(JSON)a=JSON.stringify(a,function(a,b){return OSF.OUtil.isDate(this[a])?OSF.DDA.SettingsManager.DateJSONPrefix+this[a].getTime()+OSF.DDA.SettingsManager.DataJSONSuffix:b});else a=Sys.Serialization.JavaScriptSerializer.serialize(a);d[c]=a}catch(e){}}return d},deserializeSettings:function(b){var d={};b=b||{};for(var c in b){var a=b[c];try{if(JSON)a=JSON.parse(a,function(c,a){var b;if(typeof a==="string"&&a&&a.length>6&&a.slice(0,5)===OSF.DDA.SettingsManager.DateJSONPrefix&&a.slice(-1)===OSF.DDA.SettingsManager.DataJSONSuffix){b=new Date(parseInt(a.slice(5,-1)));if(b)return b}return a});else a=Sys.Serialization.JavaScriptSerializer.deserialize(a,true);d[c]=a}catch(e){}}return d}};OSF.DDA.OMFactory={manufactureBinding:function(a,c){var d=a[OSF.DDA.BindingProperties.Id],g=a[OSF.DDA.BindingProperties.RowCount],f=a[OSF.DDA.BindingProperties.ColumnCount],h=a[OSF.DDA.BindingProperties.HasHeaders],b;switch(a[OSF.DDA.BindingProperties.Type]){case Microsoft.Office.WebExtension.BindingType.Text:b=new OSF.DDA.TextBinding(d,c);break;case Microsoft.Office.WebExtension.BindingType.Matrix:b=new OSF.DDA.MatrixBinding(d,c,g,f);break;case Microsoft.Office.WebExtension.BindingType.Table:var i=function(){return OSF.DDA.ExcelDocument&&Microsoft.Office.WebExtension.context.document&&Microsoft.Office.WebExtension.context.document instanceof OSF.DDA.ExcelDocument},e;if(i()&&OSF.DDA.ExcelTableBinding)e=OSF.DDA.ExcelTableBinding;else e=OSF.DDA.TableBinding;b=new e(d,c,g,f,h);break;default:b=new OSF.DDA.UnknownBinding(d,c)}return b},manufactureTableData:function(a){return new Microsoft.Office.WebExtension.TableData(a[OSF.DDA.TableDataProperties.TableRows],a[OSF.DDA.TableDataProperties.TableHeaders])},manufactureDataNode:function(a){if(a)return new OSF.DDA.CustomXmlNode(a[OSF.DDA.DataNodeProperties.Handle],a[OSF.DDA.DataNodeProperties.NodeType],a[OSF.DDA.DataNodeProperties.NamespaceUri],a[OSF.DDA.DataNodeProperties.BaseName])},manufactureDataPart:function(a,b){return new OSF.DDA.CustomXmlPart(b,a[OSF.DDA.DataPartProperties.Id],a[OSF.DDA.DataPartProperties.BuiltIn])},manufactureEventArgs:function(d,c,a){var b;switch(d){case Microsoft.Office.WebExtension.EventType.DocumentSelectionChanged:b=new OSF.DDA.DocumentSelectionChangedEventArgs(c);break;case Microsoft.Office.WebExtension.EventType.BindingSelectionChanged:b=new OSF.DDA.BindingSelectionChangedEventArgs(this.manufactureBinding(a,c.document),a[OSF.DDA.PropertyDescriptors.Subset]);break;case Microsoft.Office.WebExtension.EventType.BindingDataChanged:b=new OSF.DDA.BindingDataChangedEventArgs(this.manufactureBinding(a,c.document));break;case Microsoft.Office.WebExtension.EventType.SettingsChanged:b=new OSF.DDA.SettingsChangedEventArgs(c);break;case Microsoft.Office.Internal.EventType.OfficeThemeChanged:b=new OSF.DDA.OfficeThemeChangedEventArgs(a);break;case Microsoft.Office.Internal.EventType.DocumentThemeChanged:b=new OSF.DDA.DocumentThemeChangedEventArgs(a);break;case Microsoft.Office.WebExtension.EventType.ActiveViewChanged:b=new OSF.DDA.ActiveViewChangedEventArgs(a);break;case Microsoft.Office.WebExtension.EventType.AppCommandInvoked:b=OSF.DDA.AppCommand.AppCommandInvokedEventArgs.create(a);break;case Microsoft.Office.WebExtension.EventType.DataNodeInserted:b=new OSF.DDA.NodeInsertedEventArgs(this.manufactureDataNode(a[OSF.DDA.DataNodeEventProperties.NewNode]),a[OSF.DDA.DataNodeEventProperties.InUndoRedo]);break;case Microsoft.Office.WebExtension.EventType.DataNodeReplaced:b=new OSF.DDA.NodeReplacedEventArgs(this.manufactureDataNode(a[OSF.DDA.DataNodeEventProperties.OldNode]),this.manufactureDataNode(a[OSF.DDA.DataNodeEventProperties.NewNode]),a[OSF.DDA.DataNodeEventProperties.InUndoRedo]);break;case Microsoft.Office.WebExtension.EventType.DataNodeDeleted:b=new OSF.DDA.NodeDeletedEventArgs(this.manufactureDataNode(a[OSF.DDA.DataNodeEventProperties.OldNode]),this.manufactureDataNode(a[OSF.DDA.DataNodeEventProperties.NextSiblingNode]),a[OSF.DDA.DataNodeEventProperties.InUndoRedo]);break;case Microsoft.Office.WebExtension.EventType.TaskSelectionChanged:b=new OSF.DDA.TaskSelectionChangedEventArgs(c);break;case Microsoft.Office.WebExtension.EventType.ResourceSelectionChanged:b=new OSF.DDA.ResourceSelectionChangedEventArgs(c);break;case Microsoft.Office.WebExtension.EventType.ViewSelectionChanged:b=new OSF.DDA.ViewSelectionChangedEventArgs(c);break;case Microsoft.Office.WebExtension.EventType.DialogMessageReceived:b=new OSF.DDA.DialogEventArgs(a);break;default:throw OsfMsAjaxFactory.msAjaxError.argument(Microsoft.Office.WebExtension.Parameters.EventType,OSF.OUtil.formatString(Strings.OfficeOM.L_NotSupportedEventType,d));}return b}};OSF.DDA.UI={};OSF.DDA.UI.ParentUI=function(){var c=new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.DialogMessageReceived,Microsoft.Office.WebExtension.EventType.DialogEventReceived]),b=OSF.DDA.AsyncMethodNames.DisplayDialogAsync.displayName,a=this;!a[b]&&OSF.OUtil.defineEnumerableProperty(a,b,{value:function(){var b=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.OpenDialog];b(arguments,c,a)}});OSF.OUtil.finalizeProperties(this)};OSF.DDA.UI.ChildUI=function(){var b=OSF.DDA.SyncMethodNames.MessageParent.displayName,a=this;!a[b]&&OSF.OUtil.defineEnumerableProperty(a,b,{value:function(){var b=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.MessageParent];return b(arguments,a)}});OSF.OUtil.finalizeProperties(this)};OSF.DialogHandler=function(){};OSF.DDA.DialogEventArgs=function(a){if(a[OSF.DDA.PropertyDescriptors.MessageType]==OSF.DialogMessageType.DialogMessageReceived)OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DialogMessageReceived},message:{value:a[OSF.DDA.PropertyDescriptors.MessageContent]}});else OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DialogEventReceived},error:{value:a[OSF.DDA.PropertyDescriptors.MessageType]}})};OSF.DDA.ListType=function(){var a={};a[OSF.DDA.ListDescriptors.BindingList]=OSF.DDA.PropertyDescriptors.BindingProperties;a[OSF.DDA.ListDescriptors.DataPartList]=OSF.DDA.PropertyDescriptors.DataPartProperties;a[OSF.DDA.ListDescriptors.DataNodeList]=OSF.DDA.PropertyDescriptors.DataNodeProperties;return{isListType:function(b){return OSF.OUtil.listContainsKey(a,b)},getDescriptor:function(b){return a[b]}}}();OSF.DDA.ApiMethodCall=function(b,e,d,f,g){var c=b.length,a=OSF.OUtil.delayExecutionAndCache(function(){return OSF.OUtil.formatString(Strings.OfficeOM.L_InvalidParameters,g)});this.verifyArguments=function(d,f){for(var e in d){var b=d[e],c=f[e];if(b["enum"])switch(typeof c){case"string":if(OSF.OUtil.listContainsValue(b["enum"],c))break;case"undefined":throw OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration;default:throw a();}if(b.types)if(!OSF.OUtil.listContainsValue(b.types,typeof c))throw a();}};this.extractRequiredArguments=function(g,l,j){if(g.length<c)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_MissingRequiredArguments);for(var e=[],d=0;d<c;d++)e.push(g[d]);this.verifyArguments(b,e);var i={};for(d=0;d<c;d++){var f=b[d],h=e[d];if(f.verify){var k=f.verify(h,l,j);if(!k)throw a();}i[f.name]=h}return i};this.fillOptions=function(a,f,h,g){a=a||{};for(var d in e)if(!OSF.OUtil.listContainsKey(a,d)){var c=undefined,b=e[d];if(b.calculate&&f)c=b.calculate(f,h,g);if(!c&&b.defaultValue!==undefined)c=b.defaultValue;a[d]=c}return a};this.constructCallArgs=function(c,e,g,b){var a={};for(var i in c)a[i]=c[i];for(var h in e)a[h]=e[h];for(var j in d)a[j]=d[j](g,b);if(f)a=f(a,g,b);return a}};OSF.DDA.AsyncMethodCall=function(c,d,h,e,f,i,j){var b=c.length,a=new OSF.DDA.ApiMethodCall(c,d,h,i,j);function g(g,i,k,j){if(g.length>b+2)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyArguments);for(var c,e,h=g.length-1;h>=b;h--){var f=g[h];switch(typeof f){case"object":if(c)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyOptionalObjects);else c=f;break;case"function":if(e)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyOptionalFunction);else e=f;break;default:throw OsfMsAjaxFactory.msAjaxError.argument(Strings.OfficeOM.L_InValidOptionalArgument);break}}c=a.fillOptions(c,i,k,j);if(e)if(c[Microsoft.Office.WebExtension.Parameters.Callback])throw Strings.OfficeOM.L_RedundantCallbackSpecification;else c[Microsoft.Office.WebExtension.Parameters.Callback]=e;a.verifyArguments(d,c);return c}this.verifyAndExtractCall=function(e,c,b){var d=a.extractRequiredArguments(e,c,b),h=g(e,d,c,b),f=a.constructCallArgs(d,h,c,b);return f};this.processResponse=function(c,b,d,g){var a;if(c==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)if(e)a=e(b,d,g);else a=b;else if(f)a=f(c,b);else a=OSF.DDA.ErrorCodeManager.getErrorArgs(c);return a};this.getCallArgs=function(f){for(var a,c,e=f.length-1;e>=b;e--){var d=f[e];switch(typeof d){case"object":a=d;break;case"function":c=d;break}}a=a||{};if(c)a[Microsoft.Office.WebExtension.Parameters.Callback]=c;return a}};OSF.DDA.SyncMethodCall=function(b,c,f,g,h){var d=b.length,a=new OSF.DDA.ApiMethodCall(b,c,f,g,h);function e(e,h,j,i){if(e.length>d+1)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyArguments);for(var b,k,f=e.length-1;f>=d;f--){var g=e[f];switch(typeof g){case"object":if(b)throw OsfMsAjaxFactory.msAjaxError.parameterCount(Strings.OfficeOM.L_TooManyOptionalObjects);else b=g;break;default:throw OsfMsAjaxFactory.msAjaxError.argument(Strings.OfficeOM.L_InValidOptionalArgument);break}}b=a.fillOptions(b,h,j,i);a.verifyArguments(c,b);return b}this.verifyAndExtractCall=function(f,c,b){var d=a.extractRequiredArguments(f,c,b),h=e(f,d,c,b),g=a.constructCallArgs(d,h,c,b);return g}};OSF.DDA.ConvertToDocumentTheme=function(d){for(var b=[{name:"primaryFontColor",needToConvertToHex:true},{name:"primaryBackgroundColor",needToConvertToHex:true},{name:"secondaryFontColor",needToConvertToHex:true},{name:"secondaryBackgroundColor",needToConvertToHex:true},{name:"accent1",needToConvertToHex:true},{name:"accent2",needToConvertToHex:true},{name:"accent3",needToConvertToHex:true},{name:"accent4",needToConvertToHex:true},{name:"accent5",needToConvertToHex:true},{name:"accent6",needToConvertToHex:true},{name:"hyperlink",needToConvertToHex:true},{name:"followedHyperlink",needToConvertToHex:true},{name:"headerLatinFont",needToConvertToHex:false},{name:"headerEastAsianFont",needToConvertToHex:false},{name:"headerScriptFont",needToConvertToHex:false},{name:"headerLocalizedFont",needToConvertToHex:false},{name:"bodyLatinFont",needToConvertToHex:false},{name:"bodyEastAsianFont",needToConvertToHex:false},{name:"bodyScriptFont",needToConvertToHex:false},{name:"bodyLocalizedFont",needToConvertToHex:false}],c={},a=0;a<b.length;a++)if(b[a].needToConvertToHex)c[b[a].name]=OSF.OUtil.convertIntToHex(d[b[a].name]);else c[b[a].name]=d[b[a].name];return c};OSF.DDA.ConvertToOfficeTheme=function(a){var b={};for(var c in a)b[c]=OSF.OUtil.convertIntToHex(a[c]);return b};OSF.DDA.AsyncMethodNames={};OSF.DDA.AsyncMethodNames.addNames=function(b){for(var a in b){var c={};OSF.OUtil.defineEnumerableProperties(c,{id:{value:a},displayName:{value:b[a]}});OSF.DDA.AsyncMethodNames[a]=c}};OSF.DDA.AsyncMethodNames.addNames({GoToByIdAsync:"goToByIdAsync",GetSelectedDataAsync:"getSelectedDataAsync",SetSelectedDataAsync:"setSelectedDataAsync",GetDocumentCopyAsync:"getFileAsync",GetDocumentCopyChunkAsync:"getSliceAsync",ReleaseDocumentCopyAsync:"closeAsync",GetFilePropertiesAsync:"getFilePropertiesAsync",AddFromSelectionAsync:"addFromSelectionAsync",AddFromPromptAsync:"addFromPromptAsync",AddFromNamedItemAsync:"addFromNamedItemAsync",GetAllAsync:"getAllAsync",GetByIdAsync:"getByIdAsync",ReleaseByIdAsync:"releaseByIdAsync",GetDataAsync:"getDataAsync",SetDataAsync:"setDataAsync",AddRowsAsync:"addRowsAsync",AddColumnsAsync:"addColumnsAsync",DeleteAllDataValuesAsync:"deleteAllDataValuesAsync",ClearFormatsAsync:"clearFormatsAsync",SetTableOptionsAsync:"setTableOptionsAsync",SetFormatsAsync:"setFormatsAsync",RefreshAsync:"refreshAsync",SaveAsync:"saveAsync",AddHandlerAsync:"addHandlerAsync",RemoveHandlerAsync:"removeHandlerAsync",GetActiveViewAsync:"getActiveViewAsync",AppCommandInvocationCompletedAsync:"appCommandInvocationCompletedAsync",AddDataPartAsync:"addAsync",GetDataPartByIdAsync:"getByIdAsync",GetDataPartsByNameSpaceAsync:"getByNamespaceAsync",DeleteDataPartAsync:"deleteAsync",GetPartNodesAsync:"getNodesAsync",GetPartXmlAsync:"getXmlAsync",AddDataPartNamespaceAsync:"addNamespaceAsync",GetDataPartNamespaceAsync:"getNamespaceAsync",GetDataPartPrefixAsync:"getPrefixAsync",GetRelativeNodesAsync:"getNodesAsync",GetNodeValueAsync:"getNodeValueAsync",GetNodeXmlAsync:"getXmlAsync",SetNodeValueAsync:"setNodeValueAsync",SetNodeXmlAsync:"setXmlAsync",GetNodeTextAsync:"getTextAsync",SetNodeTextAsync:"setTextAsync",GetOfficeThemeAsync:"getOfficeThemeAsync",GetDocumentThemeAsync:"getDocumentThemeAsync",GetSelectedTask:"getSelectedTaskAsync",GetTask:"getTaskAsync",GetWSSUrl:"getWSSUrlAsync",GetTaskField:"getTaskFieldAsync",GetSelectedResource:"getSelectedResourceAsync",GetResourceField:"getResourceFieldAsync",GetProjectField:"getProjectFieldAsync",GetSelectedView:"getSelectedViewAsync",DisplayDialogAsync:"displayDialogAsync",CloseAsync:"close"});OSF.DDA.SyncMethodNames={};OSF.DDA.SyncMethodNames.addNames=function(b){for(var a in b){var c={};OSF.OUtil.defineEnumerableProperties(c,{id:{value:a},displayName:{value:b[a]}});OSF.DDA.SyncMethodNames[a]=c}};OSF.DDA.SyncMethodNames.addNames({MessageParent:"messageParent",AddMessageHandler:"addEventHandler"});OSF.DDA.AsyncMethodCallFactory=function(){function a(a){var c=null;if(a){c={};for(var d=a.length,b=0;b<d;b++)c[a[b].name]=a[b].value}return c}return{manufacture:function(b){var d=b.supportedOptions?a(b.supportedOptions):[],c=b.privateStateCallbacks?a(b.privateStateCallbacks):[];return new OSF.DDA.AsyncMethodCall(b.requiredArguments||[],d,c,b.onSucceeded,b.onFailed,b.checkCallArgs,b.method.displayName)}}}();OSF.DDA.SyncMethodCallFactory=function(){function a(a){var c=null;if(a){c={};for(var d=a.length,b=0;b<d;b++)c[a[b].name]=a[b].value}return c}return{manufacture:function(b){var c=b.supportedOptions?a(b.supportedOptions):[];return new OSF.DDA.SyncMethodCall(b.requiredArguments||[],c,b.privateStateCallbacks,b.checkCallArgs,b.method.displayName)}}}();OSF.DDA.AsyncMethodCalls={};OSF.DDA.AsyncMethodCalls.define=function(a){OSF.DDA.AsyncMethodCalls[a.method.id]=OSF.DDA.AsyncMethodCallFactory.manufacture(a)};(function(){function a(a){OSF.DDA.AsyncMethodCalls.define(a)}function c(b,d,c){var a=b[Microsoft.Office.WebExtension.Parameters.Data];if(a&&(a[OSF.DDA.TableDataProperties.TableRows]!=undefined||a[OSF.DDA.TableDataProperties.TableHeaders]!=undefined))a=OSF.DDA.OMFactory.manufactureTableData(a);a=OSF.DDA.DataCoercion.coerceData(a,c[Microsoft.Office.WebExtension.Parameters.CoercionType]);return a==undefined?null:a}function e(a){return OSF.DDA.OMFactory.manufactureBinding(a,Microsoft.Office.WebExtension.context.document)}function f(a){return OSF.DDA.OMFactory.manufactureDataPart(a,Microsoft.Office.WebExtension.context.document.customXmlParts)}function h(a){return OSF.DDA.OMFactory.manufactureDataNode(a)}function b(a){return a.id}function g(b,a){return a}function d(b,a){return a}a({method:OSF.DDA.AsyncMethodNames.GoToByIdAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Id,types:["string","number"]},{name:Microsoft.Office.WebExtension.Parameters.GoToType,"enum":Microsoft.Office.WebExtension.GoToType}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.SelectionMode,value:{"enum":Microsoft.Office.WebExtension.SelectionMode,defaultValue:Microsoft.Office.WebExtension.SelectionMode.Default}}]});a({method:OSF.DDA.AsyncMethodNames.GetSelectedDataAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.CoercionType,"enum":Microsoft.Office.WebExtension.CoercionType}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.ValueFormat,value:{"enum":Microsoft.Office.WebExtension.ValueFormat,defaultValue:Microsoft.Office.WebExtension.ValueFormat.Unformatted}},{name:Microsoft.Office.WebExtension.Parameters.FilterType,value:{"enum":Microsoft.Office.WebExtension.FilterType,defaultValue:Microsoft.Office.WebExtension.FilterType.All}}],privateStateCallbacks:[],onSucceeded:c});a({method:OSF.DDA.AsyncMethodNames.SetSelectedDataAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Data,types:["string","object","number","boolean"]}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.CoercionType,value:{"enum":Microsoft.Office.WebExtension.CoercionType,calculate:function(a){return OSF.DDA.DataCoercion.determineCoercionType(a[Microsoft.Office.WebExtension.Parameters.Data])}}},{name:Microsoft.Office.WebExtension.Parameters.CellFormat,value:{types:["object"],defaultValue:[]}},{name:Microsoft.Office.WebExtension.Parameters.TableOptions,value:{types:["object"],defaultValue:[]}},{name:Microsoft.Office.WebExtension.Parameters.ImageLeft,value:{types:["number","boolean"],defaultValue:false}},{name:Microsoft.Office.WebExtension.Parameters.ImageTop,value:{types:["number","boolean"],defaultValue:false}},{name:Microsoft.Office.WebExtension.Parameters.ImageWidth,value:{types:["number","boolean"],defaultValue:false}},{name:Microsoft.Office.WebExtension.Parameters.ImageHeight,value:{types:["number","boolean"],defaultValue:false}}],privateStateCallbacks:[]});a({method:OSF.DDA.AsyncMethodNames.GetFilePropertiesAsync,onSucceeded:function(a,c,b){return new Microsoft.Office.WebExtension.FileProperties(a)}});a({method:OSF.DDA.AsyncMethodNames.GetDocumentCopyAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.FileType,"enum":Microsoft.Office.WebExtension.FileType}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.SliceSize,value:{types:["number"],defaultValue:4*1024*1024}}],onSucceeded:function(a,c,b){return new OSF.DDA.File(a[OSF.DDA.FileProperties.Handle],a[OSF.DDA.FileProperties.FileSize],b[Microsoft.Office.WebExtension.Parameters.SliceSize])}});a({method:OSF.DDA.AsyncMethodNames.GetDocumentCopyChunkAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.SliceIndex,types:["number"]}],privateStateCallbacks:[{name:OSF.DDA.FileProperties.Handle,value:function(b,a){return a[OSF.DDA.FileProperties.Handle]}},{name:OSF.DDA.FileProperties.SliceSize,value:function(b,a){return a[OSF.DDA.FileProperties.SliceSize]}}],checkCallArgs:function(a,d,c){var b=a[Microsoft.Office.WebExtension.Parameters.SliceIndex];if(b<0||b>=d.sliceCount)throw OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange;a[OSF.DDA.FileSliceOffset]=parseInt(b*c[OSF.DDA.FileProperties.SliceSize]);return a},onSucceeded:function(a,d,c){var b={};OSF.OUtil.defineEnumerableProperties(b,{data:{value:a[Microsoft.Office.WebExtension.Parameters.Data]},index:{value:c[Microsoft.Office.WebExtension.Parameters.SliceIndex]},size:{value:a[OSF.DDA.FileProperties.SliceSize]}});return b}});a({method:OSF.DDA.AsyncMethodNames.ReleaseDocumentCopyAsync,privateStateCallbacks:[{name:OSF.DDA.FileProperties.Handle,value:function(b,a){return a[OSF.DDA.FileProperties.Handle]}}]});a({method:OSF.DDA.AsyncMethodNames.AddFromSelectionAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.BindingType,"enum":Microsoft.Office.WebExtension.BindingType}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:{types:["string"],calculate:OSF.DDA.generateBindingId}}],privateStateCallbacks:[],onSucceeded:e});a({method:OSF.DDA.AsyncMethodNames.AddFromPromptAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.BindingType,"enum":Microsoft.Office.WebExtension.BindingType}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:{types:["string"],calculate:OSF.DDA.generateBindingId}},{name:Microsoft.Office.WebExtension.Parameters.PromptText,value:{types:["string"],calculate:function(){return Strings.OfficeOM.L_AddBindingFromPromptDefaultText}}}],privateStateCallbacks:[],onSucceeded:e});a({method:OSF.DDA.AsyncMethodNames.AddFromNamedItemAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.ItemName,types:["string"]},{name:Microsoft.Office.WebExtension.Parameters.BindingType,"enum":Microsoft.Office.WebExtension.BindingType}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:{types:["string"],calculate:OSF.DDA.generateBindingId}}],privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.FailOnCollision,value:function(){return true}}],onSucceeded:e});a({method:OSF.DDA.AsyncMethodNames.GetAllAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[],onSucceeded:function(a){return OSF.OUtil.mapList(a[OSF.DDA.ListDescriptors.BindingList],e)}});a({method:OSF.DDA.AsyncMethodNames.GetByIdAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Id,types:["string"]}],supportedOptions:[],privateStateCallbacks:[],onSucceeded:e});a({method:OSF.DDA.AsyncMethodNames.ReleaseByIdAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Id,types:["string"]}],supportedOptions:[],privateStateCallbacks:[],onSucceeded:function(d,a,b){var c=b[Microsoft.Office.WebExtension.Parameters.Id];delete a._eventDispatches[c]}});a({method:OSF.DDA.AsyncMethodNames.GetDataAsync,requiredArguments:[],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.CoercionType,value:{"enum":Microsoft.Office.WebExtension.CoercionType,calculate:function(b,a){return OSF.DDA.DataCoercion.getCoercionDefaultForBinding(a.type)}}},{name:Microsoft.Office.WebExtension.Parameters.ValueFormat,value:{"enum":Microsoft.Office.WebExtension.ValueFormat,defaultValue:Microsoft.Office.WebExtension.ValueFormat.Unformatted}},{name:Microsoft.Office.WebExtension.Parameters.FilterType,value:{"enum":Microsoft.Office.WebExtension.FilterType,defaultValue:Microsoft.Office.WebExtension.FilterType.All}},{name:Microsoft.Office.WebExtension.Parameters.StartRow,value:{types:["number"],defaultValue:0}},{name:Microsoft.Office.WebExtension.Parameters.StartColumn,value:{types:["number"],defaultValue:0}},{name:Microsoft.Office.WebExtension.Parameters.RowCount,value:{types:["number"],defaultValue:0}},{name:Microsoft.Office.WebExtension.Parameters.ColumnCount,value:{types:["number"],defaultValue:0}}],checkCallArgs:function(a,b,c){if(a[Microsoft.Office.WebExtension.Parameters.StartRow]==0&&a[Microsoft.Office.WebExtension.Parameters.StartColumn]==0&&a[Microsoft.Office.WebExtension.Parameters.RowCount]==0&&a[Microsoft.Office.WebExtension.Parameters.ColumnCount]==0){delete a[Microsoft.Office.WebExtension.Parameters.StartRow];delete a[Microsoft.Office.WebExtension.Parameters.StartColumn];delete a[Microsoft.Office.WebExtension.Parameters.RowCount];delete a[Microsoft.Office.WebExtension.Parameters.ColumnCount]}if(a[Microsoft.Office.WebExtension.Parameters.CoercionType]!=OSF.DDA.DataCoercion.getCoercionDefaultForBinding(b.type)&&(a[Microsoft.Office.WebExtension.Parameters.StartRow]||a[Microsoft.Office.WebExtension.Parameters.StartColumn]||a[Microsoft.Office.WebExtension.Parameters.RowCount]||a[Microsoft.Office.WebExtension.Parameters.ColumnCount]))throw OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding;return a},privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:b}],onSucceeded:c});a({method:OSF.DDA.AsyncMethodNames.SetDataAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Data,types:["string","object","number","boolean"]}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.CoercionType,value:{"enum":Microsoft.Office.WebExtension.CoercionType,calculate:function(a){return OSF.DDA.DataCoercion.determineCoercionType(a[Microsoft.Office.WebExtension.Parameters.Data])}}},{name:Microsoft.Office.WebExtension.Parameters.StartRow,value:{types:["number"],defaultValue:0}},{name:Microsoft.Office.WebExtension.Parameters.StartColumn,value:{types:["number"],defaultValue:0}},{name:Microsoft.Office.WebExtension.Parameters.CellFormat,value:{types:["object"],defaultValue:[]}},{name:Microsoft.Office.WebExtension.Parameters.TableOptions,value:{types:["object"],defaultValue:[]}}],checkCallArgs:function(a,c,d){var b=Microsoft.Office.WebExtension.Parameters;if(a[b.StartRow]==0&&a[b.StartColumn]==0&&OSF.OUtil.isArray(a[b.CellFormat])&&a[b.CellFormat].length===0&&OSF.OUtil.isArray(a[b.TableOptions])&&a[b.TableOptions].length===0){delete a[b.StartRow];delete a[b.StartColumn];delete a[b.CellFormat];delete a[b.TableOptions]}if(a[b.CoercionType]!=OSF.DDA.DataCoercion.getCoercionDefaultForBinding(c.type)&&(a[b.StartRow]&&a[b.StartRow]!=0||a[b.StartColumn]&&a[b.StartColumn]!=0||a[b.CellFormat]||a[b.TableOptions]))throw OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotMatchBinding;return a},privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:b}]});a({method:OSF.DDA.AsyncMethodNames.AddRowsAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Data,types:["object"]}],supportedOptions:[],privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:b}]});a({method:OSF.DDA.AsyncMethodNames.AddColumnsAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Data,types:["object"]}],supportedOptions:[],privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:b}]});a({method:OSF.DDA.AsyncMethodNames.DeleteAllDataValuesAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:b}]});a({method:OSF.DDA.AsyncMethodNames.ClearFormatsAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:b}]});a({method:OSF.DDA.AsyncMethodNames.SetTableOptionsAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.TableOptions,defaultValue:[]}],privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:b}]});a({method:OSF.DDA.AsyncMethodNames.SetFormatsAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.CellFormat,defaultValue:[]}],privateStateCallbacks:[{name:Microsoft.Office.WebExtension.Parameters.Id,value:b}]});a({method:OSF.DDA.AsyncMethodNames.RefreshAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[],onSucceeded:function(a,d){var b=a[OSF.DDA.SettingsManager.SerializedSettings],c=OSF.DDA.SettingsManager.deserializeSettings(b);return c}});a({method:OSF.DDA.AsyncMethodNames.SaveAsync,requiredArguments:[],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.OverwriteIfStale,value:{types:["boolean"],defaultValue:true}}],privateStateCallbacks:[{name:OSF.DDA.SettingsManager.SerializedSettings,value:function(b,a){return OSF.DDA.SettingsManager.serializeSettings(a)}}]});a({method:OSF.DDA.AsyncMethodNames.AddHandlerAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.EventType,"enum":Microsoft.Office.WebExtension.EventType,verify:function(b,c,a){return a.supportsEvent(b)}},{name:Microsoft.Office.WebExtension.Parameters.Handler,types:["function"]}],supportedOptions:[],privateStateCallbacks:[]});a({method:OSF.DDA.AsyncMethodNames.RemoveHandlerAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.EventType,"enum":Microsoft.Office.WebExtension.EventType,verify:function(b,c,a){return a.supportsEvent(b)}}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.Handler,value:{types:["function"],defaultValue:null}}],privateStateCallbacks:[]});a({method:OSF.DDA.AsyncMethodNames.GetDocumentThemeAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[],onSucceeded:OSF.DDA.ConvertToDocumentTheme});a({method:OSF.DDA.AsyncMethodNames.GetOfficeThemeAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[],onSucceeded:OSF.DDA.ConvertToOfficeTheme});a({method:OSF.DDA.AsyncMethodNames.GetActiveViewAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[],onSucceeded:function(b){var a=b[Microsoft.Office.WebExtension.Parameters.ActiveView];return a==undefined?null:a}});a({method:OSF.DDA.AsyncMethodNames.AddDataPartAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Xml,types:["string"]}],supportedOptions:[],privateStateCallbacks:[],onSucceeded:f});a({method:OSF.DDA.AsyncMethodNames.GetDataPartByIdAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Id,types:["string"]}],supportedOptions:[],privateStateCallbacks:[],onSucceeded:f});a({method:OSF.DDA.AsyncMethodNames.GetDataPartsByNameSpaceAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Namespace,types:["string"]}],supportedOptions:[],privateStateCallbacks:[],onSucceeded:function(a){return OSF.OUtil.mapList(a[OSF.DDA.ListDescriptors.DataPartList],f)}});a({method:OSF.DDA.AsyncMethodNames.DeleteDataPartAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataPartProperties.Id,value:b}]});a({method:OSF.DDA.AsyncMethodNames.GetPartNodesAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.XPath,types:["string"]}],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataPartProperties.Id,value:b}],onSucceeded:function(a){return OSF.OUtil.mapList(a[OSF.DDA.ListDescriptors.DataNodeList],h)}});a({method:OSF.DDA.AsyncMethodNames.GetPartXmlAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataPartProperties.Id,value:b}],onSucceeded:c});a({method:OSF.DDA.AsyncMethodNames.AddDataPartNamespaceAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Prefix,types:["string"]},{name:Microsoft.Office.WebExtension.Parameters.Namespace,types:["string"]}],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataPartProperties.Id,value:g}]});a({method:OSF.DDA.AsyncMethodNames.GetDataPartNamespaceAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Prefix,types:["string"]}],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataPartProperties.Id,value:g}],onSucceeded:c});a({method:OSF.DDA.AsyncMethodNames.GetDataPartPrefixAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Namespace,types:["string"]}],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataPartProperties.Id,value:g}],onSucceeded:c});a({method:OSF.DDA.AsyncMethodNames.GetRelativeNodesAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.XPath,types:["string"]}],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataNodeProperties.Handle,value:d}],onSucceeded:function(a){return OSF.OUtil.mapList(a[OSF.DDA.ListDescriptors.DataNodeList],h)}});a({method:OSF.DDA.AsyncMethodNames.GetNodeValueAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataNodeProperties.Handle,value:d}],onSucceeded:c});a({method:OSF.DDA.AsyncMethodNames.GetNodeXmlAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataNodeProperties.Handle,value:d}],onSucceeded:c});a({method:OSF.DDA.AsyncMethodNames.SetNodeValueAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Data,types:["string"]}],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataNodeProperties.Handle,value:d}]});a({method:OSF.DDA.AsyncMethodNames.SetNodeXmlAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Xml,types:["string"]}],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataNodeProperties.Handle,value:d}]});a({method:OSF.DDA.AsyncMethodNames.GetNodeTextAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataNodeProperties.Handle,value:d}],onSucceeded:c});a({method:OSF.DDA.AsyncMethodNames.SetNodeTextAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Text,types:["string"]}],supportedOptions:[],privateStateCallbacks:[{name:OSF.DDA.DataNodeProperties.Handle,value:d}]});a({method:OSF.DDA.AsyncMethodNames.GetSelectedTask,onSucceeded:function(a){return a[Microsoft.Office.WebExtension.Parameters.TaskId]}});a({method:OSF.DDA.AsyncMethodNames.GetTask,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.TaskId,types:["string"]}]});a({method:OSF.DDA.AsyncMethodNames.GetTaskField,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.TaskId,types:["string"]},{name:Microsoft.Office.WebExtension.Parameters.FieldId,types:["number"]}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.GetRawValue,value:{types:["boolean"],defaultValue:false}}]});a({method:OSF.DDA.AsyncMethodNames.GetResourceField,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.ResourceId,types:["string"]},{name:Microsoft.Office.WebExtension.Parameters.FieldId,types:["number"]}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.GetRawValue,value:{types:["boolean"],defaultValue:false}}]});a({method:OSF.DDA.AsyncMethodNames.GetProjectField,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.FieldId,types:["number"]}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.GetRawValue,value:{types:["boolean"],defaultValue:false}}]});a({method:OSF.DDA.AsyncMethodNames.GetSelectedResource,onSucceeded:function(a){return a[Microsoft.Office.WebExtension.Parameters.ResourceId]}});a({method:OSF.DDA.AsyncMethodNames.GetWSSUrl});a({method:OSF.DDA.AsyncMethodNames.GetSelectedView});a({method:OSF.DDA.AsyncMethodNames.DisplayDialogAsync,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.Url,types:["string"]}],supportedOptions:[{name:Microsoft.Office.WebExtension.Parameters.Width,value:{types:["number"],defaultValue:99}},{name:Microsoft.Office.WebExtension.Parameters.Height,value:{types:["number"],defaultValue:99}},{name:Microsoft.Office.WebExtension.Parameters.RequireHTTPs,value:{types:["boolean"],defaultValue:true}},{name:Microsoft.Office.WebExtension.Parameters.XFrameDenySafe,value:{types:["boolean"],defaultValue:true}}],privateStateCallbacks:[],onSucceeded:function(c,h,g){var f=c[Microsoft.Office.WebExtension.Parameters.Id],b=c[Microsoft.Office.WebExtension.Parameters.Data],a=new OSF.DialogHandler,d=OSF.DDA.AsyncMethodNames.CloseAsync.displayName;OSF.OUtil.defineEnumerableProperty(a,d,{value:function(){var c=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.CloseDialog];c(arguments,f,b,a)}});var e=OSF.DDA.SyncMethodNames.AddMessageHandler.displayName;OSF.OUtil.defineEnumerableProperty(a,e,{value:function(){var d=OSF.DDA.SyncMethodCalls[OSF.DDA.SyncMethodNames.AddMessageHandler.id],c=d.verifyAndExtractCall(arguments,a,b),e=c[Microsoft.Office.WebExtension.Parameters.EventType],f=c[Microsoft.Office.WebExtension.Parameters.Handler];return b.addEventHandlerAndFireQueuedEvent(e,f)}});return a},checkCallArgs:function(a,c,b){if(a[Microsoft.Office.WebExtension.Parameters.Width]<=0)a[Microsoft.Office.WebExtension.Parameters.Width]=1;if(a[Microsoft.Office.WebExtension.Parameters.Width]>100)a[Microsoft.Office.WebExtension.Parameters.Width]=99;if(a[Microsoft.Office.WebExtension.Parameters.Height]<=0)a[Microsoft.Office.WebExtension.Parameters.Height]=1;if(a[Microsoft.Office.WebExtension.Parameters.Height]>100)a[Microsoft.Office.WebExtension.Parameters.Height]=99;return a}});a({method:OSF.DDA.AsyncMethodNames.CloseAsync,requiredArguments:[],supportedOptions:[],privateStateCallbacks:[]})})();OSF.DDA.SyncMethodCalls={};OSF.DDA.SyncMethodCalls.define=function(a){OSF.DDA.SyncMethodCalls[a.method.id]=OSF.DDA.SyncMethodCallFactory.manufacture(a)};(function(){OSF.DDA.SyncMethodCalls.define({method:OSF.DDA.SyncMethodNames.MessageParent,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.MessageToParent,types:["string","number","boolean"]}],supportedOptions:[]});OSF.DDA.SyncMethodCalls.define({method:OSF.DDA.SyncMethodNames.AddMessageHandler,requiredArguments:[{name:Microsoft.Office.WebExtension.Parameters.EventType,"enum":Microsoft.Office.WebExtension.EventType,verify:function(b,c,a){return a.supportsEvent(b)}},{name:Microsoft.Office.WebExtension.Parameters.Handler,types:["function"]}],supportedOptions:[]})})();OSF.DDA.HostParameterMap=function(a,b){var h="toHost",g="fromHost",d="self",f={};f[Microsoft.Office.WebExtension.Parameters.Data]={toHost:function(a){if(a.rows!==undefined){var b={};b[OSF.DDA.TableDataProperties.TableRows]=a.rows;b[OSF.DDA.TableDataProperties.TableHeaders]=a.headers;a=b}return a},fromHost:function(a){return a}};function c(j,i){var m=j?{}:undefined;for(var h in j){var e=j[h],d;if(OSF.DDA.ListType.isListType(h)){d=[];for(var n in e)d.push(c(e[n],i))}else if(OSF.OUtil.listContainsKey(f,h))d=f[h][i](e);else if(i==g&&a.preserveNesting(h))d=c(e,i);else{var k=b[h];if(k){var l=k[i];if(l){d=l[e];if(d===undefined)d=e}}else d=e}m[h]=d}return m}function i(k,j){var f;for(var c in j){var e;if(a.isComplexType(c))e=i(k,b[c][h]);else e=k[c];if(e!=undefined){if(!f)f={};var g=j[c];if(g==d)g=c;f[g]=a.pack(c,e)}}return f}function e(k,j,h){if(!h)h={};for(var f in j){var l=j[f],c;if(l==d)c=k;else c=k[l];if(c===null||c===undefined)h[f]=undefined;else{c=a.unpack(f,c);var i;if(a.isComplexType(f)){i=b[f][g];if(a.preserveNesting(f))h[f]=e(c,i);else e(c,i,h)}else{if(OSF.DDA.ListType.isListType(f)){i={};var n=OSF.DDA.ListType.getDescriptor(f);i[n]=d;for(var m in c)c[m]=e(c[m],i)}h[f]=c}}}return h}function j(k,g,a){var f=b[k][a],d;if(a=="toHost"){var j=c(g,a);d=i(j,f)}else if(a=="fromHost"){var h=e(g,f);d=c(h,a)}return d}if(!b)b={};this.setMapping=function(k,c){var a,e;if(c.map){a=c.map;e={};for(var f in a){var i=a[f];if(i==d)i=f;e[i]=f}}else{a=c.toHost;e=c.fromHost}var j=b[k]={};j[h]=a;j[g]=e};this.toHost=function(b,a){return j(b,a,h)};this.fromHost=function(a,b){return j(a,b,g)};this.self=d;this.dynamicTypes=f;this.mapValues=c;this.specialProcessorDynamicTypes=a.dynamicTypes};OSF.DDA.SpecialProcessor=function(b,a){this.sharedComplexType=[OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,OSF.DDA.EventDescriptors.DialogMessageReceivedEvent];this.isComplexType=function(a){return OSF.OUtil.listContainsValue(this.sharedComplexType,a)||OSF.OUtil.listContainsValue(b,a)};this.isDynamicType=function(b){return OSF.OUtil.listContainsKey(a,b)};this.preserveNesting=function(b){var a=[OSF.DDA.PropertyDescriptors.Subset,OSF.DDA.DataNodeEventProperties.OldNode,OSF.DDA.DataNodeEventProperties.NewNode,OSF.DDA.DataNodeEventProperties.NextSiblingNode];return OSF.OUtil.listContainsValue(a,b)};this.pack=function(c,d){var b;if(this.isDynamicType(c))b=a[c].toHost(d);else b=d;return b};this.unpack=function(c,d){var b;if(this.isDynamicType(c))b=a[c].fromHost(d);else b=d;return b}};OSF.DDA.DispIdHost.Facade=function(d,e){var a={},b=OSF.DDA.AsyncMethodNames,c=OSF.DDA.MethodDispId;a[b.GoToByIdAsync.id]=c.dispidNavigateToMethod;a[b.GetSelectedDataAsync.id]=c.dispidGetSelectedDataMethod;a[b.SetSelectedDataAsync.id]=c.dispidSetSelectedDataMethod;a[b.GetDocumentCopyChunkAsync.id]=c.dispidGetDocumentCopyChunkMethod;a[b.ReleaseDocumentCopyAsync.id]=c.dispidReleaseDocumentCopyMethod;a[b.GetDocumentCopyAsync.id]=c.dispidGetDocumentCopyMethod;a[b.AddFromSelectionAsync.id]=c.dispidAddBindingFromSelectionMethod;a[b.AddFromPromptAsync.id]=c.dispidAddBindingFromPromptMethod;a[b.AddFromNamedItemAsync.id]=c.dispidAddBindingFromNamedItemMethod;a[b.GetAllAsync.id]=c.dispidGetAllBindingsMethod;a[b.GetByIdAsync.id]=c.dispidGetBindingMethod;a[b.ReleaseByIdAsync.id]=c.dispidReleaseBindingMethod;a[b.GetDataAsync.id]=c.dispidGetBindingDataMethod;a[b.SetDataAsync.id]=c.dispidSetBindingDataMethod;a[b.GetFilePropertiesAsync.id]=c.dispidGetFilePropertiesMethod;a[b.AddRowsAsync.id]=c.dispidAddRowsMethod;a[b.AddColumnsAsync.id]=c.dispidAddColumnsMethod;a[b.DeleteAllDataValuesAsync.id]=c.dispidClearAllRowsMethod;a[b.ClearFormatsAsync.id]=c.dispidClearFormatsMethod;a[b.RefreshAsync.id]=c.dispidLoadSettingsMethod;a[b.SaveAsync.id]=c.dispidSaveSettingsMethod;a[b.SetTableOptionsAsync.id]=c.dispidSetTableOptionsMethod;a[b.SetFormatsAsync.id]=c.dispidSetFormatsMethod;a[b.GetActiveViewAsync.id]=c.dispidGetActiveViewMethod;a[b.AppCommandInvocationCompletedAsync.id]=c.dispidAppCommandInvocationCompletedMethod;a[b.AddDataPartAsync.id]=c.dispidAddDataPartMethod;a[b.GetDataPartByIdAsync.id]=c.dispidGetDataPartByIdMethod;a[b.GetDataPartsByNameSpaceAsync.id]=c.dispidGetDataPartsByNamespaceMethod;a[b.GetPartXmlAsync.id]=c.dispidGetDataPartXmlMethod;a[b.GetPartNodesAsync.id]=c.dispidGetDataPartNodesMethod;a[b.DeleteDataPartAsync.id]=c.dispidDeleteDataPartMethod;a[b.GetNodeValueAsync.id]=c.dispidGetDataNodeValueMethod;a[b.GetNodeXmlAsync.id]=c.dispidGetDataNodeXmlMethod;a[b.GetRelativeNodesAsync.id]=c.dispidGetDataNodesMethod;a[b.SetNodeValueAsync.id]=c.dispidSetDataNodeValueMethod;a[b.SetNodeXmlAsync.id]=c.dispidSetDataNodeXmlMethod;a[b.AddDataPartNamespaceAsync.id]=c.dispidAddDataNamespaceMethod;a[b.GetDataPartNamespaceAsync.id]=c.dispidGetDataUriByPrefixMethod;a[b.GetDataPartPrefixAsync.id]=c.dispidGetDataPrefixByUriMethod;a[b.GetNodeTextAsync.id]=c.dispidGetDataNodeTextMethod;a[b.SetNodeTextAsync.id]=c.dispidSetDataNodeTextMethod;a[b.GetDocumentThemeAsync.id]=c.dispidGetDocumentThemeMethod;a[b.GetOfficeThemeAsync.id]=c.dispidGetOfficeThemeMethod;a[b.GetSelectedTask.id]=c.dispidGetSelectedTaskMethod;a[b.GetTask.id]=c.dispidGetTaskMethod;a[b.GetWSSUrl.id]=c.dispidGetWSSUrlMethod;a[b.GetTaskField.id]=c.dispidGetTaskFieldMethod;a[b.GetSelectedResource.id]=c.dispidGetSelectedResourceMethod;a[b.GetResourceField.id]=c.dispidGetResourceFieldMethod;a[b.GetProjectField.id]=c.dispidGetProjectFieldMethod;a[b.GetSelectedView.id]=c.dispidGetSelectedViewMethod;b=Microsoft.Office.WebExtension.EventType;c=OSF.DDA.EventDispId;a[b.SettingsChanged]=c.dispidSettingsChangedEvent;a[b.DocumentSelectionChanged]=c.dispidDocumentSelectionChangedEvent;a[b.BindingSelectionChanged]=c.dispidBindingSelectionChangedEvent;a[b.BindingDataChanged]=c.dispidBindingDataChangedEvent;a[b.ActiveViewChanged]=c.dispidActiveViewChangedEvent;a[b.DocumentThemeChanged]=c.dispidDocumentThemeChangedEvent;a[b.OfficeThemeChanged]=c.dispidOfficeThemeChangedEvent;a[b.DialogMessageReceived]=c.dispidDialogMessageReceivedEvent,a[b.AppCommandInvoked]=c.dispidAppCommandInvokedEvent;a[b.TaskSelectionChanged]=c.dispidTaskSelectionChangedEvent;a[b.ResourceSelectionChanged]=c.dispidResourceSelectionChangedEvent;a[b.ViewSelectionChanged]=c.dispidViewSelectionChangedEvent;a[b.DataNodeInserted]=c.dispidDataNodeAddedEvent;a[b.DataNodeReplaced]=c.dispidDataNodeReplacedEvent;a[b.DataNodeDeleted]=c.dispidDataNodeDeletedEvent;function f(a,c,d,b){if(typeof a=="number"){if(!b)b=c.getCallArgs(d);OSF.DDA.issueAsyncResult(b,a,OSF.DDA.ErrorCodeManager.getErrorArgs(a))}else throw a;}this[OSF.DDA.DispIdHost.Methods.InvokeMethod]=function(n,j,k,l){var b;try{var h=n.id,c=OSF.DDA.AsyncMethodCalls[h];b=c.verifyAndExtractCall(j,k,l);var i=a[h],m=d(h),g;if(e.toHost)g=e.toHost(i,b);else g=b;m[OSF.DDA.DispIdHost.Delegates.ExecuteAsync]({dispId:i,hostCallArgs:g,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:function(f,d){var a;if(f==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)if(e.fromHost)a=e.fromHost(i,d);else a=d;else a=d;var g=c.processResponse(f,a,k,b);OSF.DDA.issueAsyncResult(b,f,g)}})}catch(o){f(o,c,j,b)}};this[OSF.DDA.DispIdHost.Methods.AddEventHandler]=function(j,g,h){var c,b,l;function i(a){if(a==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess){var e=g.addEventHandler(b,l);if(!e)a=OSF.DDA.ErrorCodeManager.errorCodes.ooeEventHandlerAdditionFailed}var d;if(a!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)d=OSF.DDA.ErrorCodeManager.getErrorArgs(a);OSF.DDA.issueAsyncResult(c,a,d)}try{var k=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.AddHandlerAsync.id];c=k.verifyAndExtractCall(j,h,g);b=c[Microsoft.Office.WebExtension.Parameters.EventType];l=c[Microsoft.Office.WebExtension.Parameters.Handler];if(g.getEventHandlerCount(b)==0){var m=a[b],n=d(b)[OSF.DDA.DispIdHost.Delegates.RegisterEventAsync];n({eventType:b,dispId:m,targetId:h.id||"",onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:i,onEvent:function(a){var c=e.fromHost(m,a);g.fireEvent(OSF.DDA.OMFactory.manufactureEventArgs(b,h,c))}})}else i(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(o){f(o,k,j,c)}};this[OSF.DDA.DispIdHost.Methods.RemoveEventHandler]=function(j,c,l){var e,b,g;function i(a){var b;if(a!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)b=OSF.DDA.ErrorCodeManager.getErrorArgs(OSF.DDA.ErrorCodeManager.errorCodes.ooeEventHandlerNotExist);OSF.DDA.issueAsyncResult(e,a,b)}try{var k=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.RemoveHandlerAsync.id];e=k.verifyAndExtractCall(j,l,c);b=e[Microsoft.Office.WebExtension.Parameters.EventType];g=e[Microsoft.Office.WebExtension.Parameters.Handler];var h;if(g==null){c.clearEventHandlers(b);h=true}else if(!c.hasEventHandler(b,g))h=false;else h=c.removeEventHandler(b,g);if(c.getEventHandlerCount(b)==0){var n=a[b],m=d(b)[OSF.DDA.DispIdHost.Delegates.UnregisterEventAsync];m({eventType:b,dispId:n,targetId:l.id||"",onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:i})}else i(h?OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess:Strings.OfficeOM.L_EventRegistrationError)}catch(o){f(o,k,j,e)}};this[OSF.DDA.DispIdHost.Methods.OpenDialog]=function(m,c,l){var g,b,h,k;function i(a){var d;if(a!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)d=OSF.DDA.ErrorCodeManager.getErrorArgs(a);else{var b={};b[Microsoft.Office.WebExtension.Parameters.Id]=k;b[Microsoft.Office.WebExtension.Parameters.Data]=c;var d=j.processResponse(a,b,l,g)}OSF.DDA.issueAsyncResult(g,a,d)}try{b=Microsoft.Office.WebExtension.EventType.DialogMessageReceived;h=Microsoft.Office.WebExtension.EventType.DialogEventReceived;(b==undefined||h==undefined)&&i(OSF.DDA.ErrorCodeManager.ooeOperationNotSupported);if(OSF.DDA.AsyncMethodNames.DisplayDialogAsync==null){i(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return}var j=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.DisplayDialogAsync.id];g=j.verifyAndExtractCall(m,l,c);c.clearEventHandlers(b);c.clearEventHandlers(h);var n=a[b],o=d(b)[OSF.DDA.DispIdHost.Delegates.RegisterEventAsync];k=g[Microsoft.Office.WebExtension.Parameters.Url]+">"+g[Microsoft.Office.WebExtension.Parameters.Width]+">"+g[Microsoft.Office.WebExtension.Parameters.Height];o({eventType:b,dispId:n,targetId:k,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:i,onEvent:function(i){var g=e.fromHost(n,i),f=OSF.DDA.OMFactory.manufactureEventArgs(b,l,g);if(f.type==h){var d=OSF.DDA.ErrorCodeManager.getErrorArgs(f.error),a={};a[OSF.DDA.AsyncResultEnum.ErrorProperties.Code]=status||OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;a[OSF.DDA.AsyncResultEnum.ErrorProperties.Name]=d.name||d;a[OSF.DDA.AsyncResultEnum.ErrorProperties.Message]=d.message||d;f.error=new OSF.DDA.Error(a[OSF.DDA.AsyncResultEnum.ErrorProperties.Name],a[OSF.DDA.AsyncResultEnum.ErrorProperties.Message],a[OSF.DDA.AsyncResultEnum.ErrorProperties.Code])}c.fireOrQueueEvent(f);if(g[OSF.DDA.PropertyDescriptors.MessageType]==OSF.DialogMessageType.DialogClosed){c.clearEventHandlers(b);c.clearEventHandlers(h)}}})}catch(p){f(p,j,m,g)}};this[OSF.DDA.DispIdHost.Methods.CloseDialog]=function(g,l,c,n){var j,b,h,e=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;function k(a){e=a}try{var i=OSF.DDA.AsyncMethodCalls[OSF.DDA.AsyncMethodNames.CloseAsync.id];j=i.verifyAndExtractCall(g,n,c);b=Microsoft.Office.WebExtension.EventType.DialogMessageReceived;h=Microsoft.Office.WebExtension.EventType.DialogEventReceived;c.clearEventHandlers(b);c.clearEventHandlers(h);var o=a[b],m=d(b)[OSF.DDA.DispIdHost.Delegates.UnregisterEventAsync];m({eventType:b,dispId:o,targetId:l,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)},onComplete:k})}catch(p){f(p,i,g,j)}if(e!=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)throw OSF.OUtil.formatString(Strings.OfficeOM.L_FunctionCallFailed,OSF.DDA.AsyncMethodNames.CloseAsync.displayName,e);};this[OSF.DDA.DispIdHost.Methods.MessageParent]=function(b,i){var e={},c=OSF.DDA.SyncMethodCalls[OSF.DDA.SyncMethodNames.MessageParent.id],f=c.verifyAndExtractCall(b,i,e),g=d(OSF.DDA.SyncMethodNames.MessageParent.id),h=g[OSF.DDA.DispIdHost.Delegates.MessageParent],j=a[OSF.DDA.SyncMethodNames.MessageParent.id];return h({dispId:j,hostCallArgs:f,onCalling:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.IssueCall)},onReceiving:function(){OSF.OUtil.writeProfilerMark(OSF.HostCallPerfMarker.ReceiveResponse)}})}};OSF.DDA.DispIdHost.addAsyncMethods=function(a,b,e){for(var f in b){var c=b[f],d=c.displayName;!a[d]&&OSF.OUtil.defineEnumerableProperty(a,d,{value:function(b){return function(){var c=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.InvokeMethod];c(b,arguments,a,e)}}(c)})}};OSF.DDA.DispIdHost.addEventSupport=function(a,b){var d=OSF.DDA.AsyncMethodNames.AddHandlerAsync.displayName,c=OSF.DDA.AsyncMethodNames.RemoveHandlerAsync.displayName;!a[d]&&OSF.OUtil.defineEnumerableProperty(a,d,{value:function(){var c=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.AddEventHandler];c(arguments,b,a)}});!a[c]&&OSF.OUtil.defineEnumerableProperty(a,c,{value:function(){var c=OSF._OfficeAppFactory.getHostFacade()[OSF.DDA.DispIdHost.Methods.RemoveEventHandler];c(arguments,b,a)}})};OSF.DDA.Context=function(a,d,e,b){OSF.OUtil.defineEnumerableProperties(this,{contentLanguage:{value:a.get_dataLocale()},displayLanguage:{value:a.get_appUILocale()},host:{value:OfficeExt.HostName.Host.getInstance().getHost(a.get_appName())},platform:{value:OfficeExt.HostName.Host.getInstance().getPlatform(a.get_appName())},diagnostics:{value:OfficeExt.HostName.Host.getInstance().getDiagnostics(a.get_appName())}});e&&OSF.OUtil.defineEnumerableProperty(this,"license",{value:e});a.ui&&OSF.OUtil.defineEnumerableProperty(this,"ui",{value:a.ui});if(a.get_isDialog()){var c=OfficeExt.Requirement.RequirementsMatrixFactory.getDialogDefaultRequirementMatrix(a);OSF.OUtil.defineEnumerableProperty(this,"requirements",{value:c})}else{d&&OSF.OUtil.defineEnumerableProperty(this,"document",{value:d});if(b){var f=b.displayName||"appOM";delete b.displayName;OSF.OUtil.defineEnumerableProperty(this,f,{value:b})}var c=OfficeExt.Requirement.RequirementsMatrixFactory.getDefaultRequirementMatrix(a);OSF.OUtil.defineEnumerableProperty(this,"requirements",{value:c})}};OSF.DDA.OutlookContext=function(b,a,c,d){OSF.DDA.OutlookContext.uber.constructor.call(this,b,null,c,d);a&&OSF.OUtil.defineEnumerableProperty(this,"roamingSettings",{value:a})};OSF.OUtil.extend(OSF.DDA.OutlookContext,OSF.DDA.Context);OSF.OUtil.defineEnumerableProperty(Microsoft.Office.WebExtension,"context",{"get":function(){var a;if(OSF&&OSF._OfficeAppFactory)a=OSF._OfficeAppFactory.getContext();return a}});Microsoft.Office.WebExtension.useShortNamespace=function(a){if(a)OSF.NamespaceManager.enableShortcut();else OSF.NamespaceManager.disableShortcut()};Microsoft.Office.WebExtension.select=function(a,b){var c;if(a&&typeof a=="string"){var d=a.indexOf("#");if(d!=-1){var h=a.substring(0,d),g=a.substring(d+1);switch(h){case"binding":case"bindings":if(g)c=new OSF.DDA.BindingPromise(g);break}}}if(!c){if(b){var e=typeof b;if(e=="function"){var f={};f[Microsoft.Office.WebExtension.Parameters.Callback]=b;OSF.DDA.issueAsyncResult(f,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext,OSF.DDA.ErrorCodeManager.getErrorArgs(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext))}else throw OSF.OUtil.formatString(Strings.OfficeOM.L_CallbackNotAFunction,e);}}else{c.onFail=b;return c}};OSF.DDA.BindingPromise=function(b,a){this._id=b;OSF.OUtil.defineEnumerableProperty(this,"onFail",{"get":function(){return a},"set":function(c){var b=typeof c;if(b!="undefined"&&b!="function")throw OSF.OUtil.formatString(Strings.OfficeOM.L_CallbackNotAFunction,b);a=c}})};OSF.DDA.BindingPromise.prototype={_fetch:function(a){if(this.binding)a&&a(this.binding);else if(!this._binding){var b=this;Microsoft.Office.WebExtension.context.document.bindings.getByIdAsync(this._id,function(c){if(c.status==Microsoft.Office.WebExtension.AsyncResultStatus.Succeeded){OSF.OUtil.defineEnumerableProperty(b,"binding",{value:c.value});a&&a(b.binding)}else if(b.onFail)b.onFail(c)})}return this},getDataAsync:function(){var a=arguments;this._fetch(function(b){b.getDataAsync.apply(b,a)});return this},setDataAsync:function(){var a=arguments;this._fetch(function(b){b.setDataAsync.apply(b,a)});return this},addHandlerAsync:function(){var a=arguments;this._fetch(function(b){b.addHandlerAsync.apply(b,a)});return this},removeHandlerAsync:function(){var a=arguments;this._fetch(function(b){b.removeHandlerAsync.apply(b,a)});return this},setTableOptionsAsync:function(){var a=arguments;this._fetch(function(b){b.setTableOptionsAsync.apply(b,a)});return this},setFormatsAsync:function(){var a=arguments;this._fetch(function(b){b.setFormatsAsync.apply(b,a)});return this},clearFormatsAsync:function(){var a=arguments;this._fetch(function(b){b.clearFormatsAsync.apply(b,a)});return this}};OSF.DDA.License=function(a){OSF.OUtil.defineEnumerableProperty(this,"value",{value:a})};OSF.DDA.Settings=function(a){a=a||{};OSF.OUtil.defineEnumerableProperties(this,{"get":{value:function(d){var c=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false}]);if(c)throw c;var b=a[d];return typeof b==="undefined"?null:b}},"set":{value:function(d,c){var b=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false},{name:"value",mayBeNull:true}]);if(b)throw b;a[d]=c}},remove:{value:function(c){var b=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false}]);if(b)throw b;delete a[c]}}});OSF.DDA.DispIdHost.addAsyncMethods(this,[OSF.DDA.AsyncMethodNames.SaveAsync],a)};OSF.DDA.RefreshableSettings=function(a){OSF.DDA.RefreshableSettings.uber.constructor.call(this,a);OSF.DDA.DispIdHost.addAsyncMethods(this,[OSF.DDA.AsyncMethodNames.RefreshAsync],a);OSF.DDA.DispIdHost.addEventSupport(this,new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.SettingsChanged]))};OSF.OUtil.extend(OSF.DDA.RefreshableSettings,OSF.DDA.Settings);OSF.DDA.OutlookAppOm=function(a,c,b){};OSF.DDA.Document=function(b,c){var a;switch(b.get_clientMode()){case OSF.ClientMode.ReadOnly:a=Microsoft.Office.WebExtension.DocumentMode.ReadOnly;break;case OSF.ClientMode.ReadWrite:a=Microsoft.Office.WebExtension.DocumentMode.ReadWrite;break}c&&OSF.OUtil.defineEnumerableProperty(this,"settings",{value:c});OSF.OUtil.defineMutableProperties(this,{mode:{value:a},url:{value:b.get_docUrl()}})};OSF.DDA.JsomDocument=function(b,c,d){OSF.DDA.JsomDocument.uber.constructor.call(this,b,d);OSF.OUtil.defineEnumerableProperty(this,"bindings",{"get":function(){return c}});var a=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[a.GetSelectedDataAsync,a.SetSelectedDataAsync]);OSF.DDA.DispIdHost.addEventSupport(this,new OSF.EventDispatch([Microsoft.Office.WebExtension.EventType.DocumentSelectionChanged]))};OSF.OUtil.extend(OSF.DDA.JsomDocument,OSF.DDA.Document);OSF.DDA.BindingFacade=function(b){this._eventDispatches=[];OSF.OUtil.defineEnumerableProperty(this,"document",{value:b});var a=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[a.AddFromSelectionAsync,a.AddFromNamedItemAsync,a.GetAllAsync,a.GetByIdAsync,a.ReleaseByIdAsync])};OSF.DDA.UnknownBinding=function(b,a){OSF.OUtil.defineEnumerableProperties(this,{document:{value:a},id:{value:b}})};OSF.DDA.Binding=function(a,c){OSF.OUtil.defineEnumerableProperties(this,{document:{value:c},id:{value:a}});var d=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[d.GetDataAsync,d.SetDataAsync]);var e=Microsoft.Office.WebExtension.EventType,b=c.bindings._eventDispatches;if(!b[a])b[a]=new OSF.EventDispatch([e.BindingSelectionChanged,e.BindingDataChanged]);var f=b[a];OSF.DDA.DispIdHost.addEventSupport(this,f)};OSF.DDA.TextBinding=function(b,a){OSF.DDA.TextBinding.uber.constructor.call(this,b,a);OSF.OUtil.defineEnumerableProperty(this,"type",{value:Microsoft.Office.WebExtension.BindingType.Text})};OSF.OUtil.extend(OSF.DDA.TextBinding,OSF.DDA.Binding);OSF.DDA.MatrixBinding=function(d,c,b,a){OSF.DDA.MatrixBinding.uber.constructor.call(this,d,c);OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.BindingType.Matrix},rowCount:{value:b?b:0},columnCount:{value:a?a:0}})};OSF.OUtil.extend(OSF.DDA.MatrixBinding,OSF.DDA.Binding);OSF.DDA.TableBinding=function(f,e,d,c,b){OSF.DDA.TableBinding.uber.constructor.call(this,f,e);OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.BindingType.Table},rowCount:{value:d?d:0},columnCount:{value:c?c:0},hasHeaders:{value:b?b:false}});var a=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[a.AddRowsAsync,a.AddColumnsAsync,a.DeleteAllDataValuesAsync])};OSF.OUtil.extend(OSF.DDA.TableBinding,OSF.DDA.Binding);Microsoft.Office.WebExtension.TableData=function(b,a){function c(a){if(a==null||a==undefined)return null;try{for(var b=OSF.DDA.DataCoercion.findArrayDimensionality(a,2);b<2;b++)a=[a];return a}catch(c){}}OSF.OUtil.defineEnumerableProperties(this,{headers:{"get":function(){return a},"set":function(b){a=c(b)}},rows:{"get":function(){return b},"set":function(a){b=a==null||OSF.OUtil.isArray(a)&&a.length==0?[]:c(a)}}});this.headers=a;this.rows=b};Microsoft.Office.WebExtension.FileProperties=function(a){OSF.OUtil.defineEnumerableProperties(this,{url:{value:a[OSF.DDA.FilePropertiesDescriptor.Url]}})};OSF.DDA.Error=function(c,a,b){OSF.OUtil.defineEnumerableProperties(this,{name:{value:c},message:{value:a},code:{value:b}})};OSF.DDA.AsyncResult=function(b,a){OSF.OUtil.defineEnumerableProperties(this,{value:{value:b[OSF.DDA.AsyncResultEnum.Properties.Value]},status:{value:a?Microsoft.Office.WebExtension.AsyncResultStatus.Failed:Microsoft.Office.WebExtension.AsyncResultStatus.Succeeded}});b[OSF.DDA.AsyncResultEnum.Properties.Context]&&OSF.OUtil.defineEnumerableProperty(this,"asyncContext",{value:b[OSF.DDA.AsyncResultEnum.Properties.Context]});a&&OSF.OUtil.defineEnumerableProperty(this,"error",{value:new OSF.DDA.Error(a[OSF.DDA.AsyncResultEnum.ErrorProperties.Name],a[OSF.DDA.AsyncResultEnum.ErrorProperties.Message],a[OSF.DDA.AsyncResultEnum.ErrorProperties.Code])})};OSF.DDA.DocumentSelectionChangedEventArgs=function(a){OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DocumentSelectionChanged},document:{value:a}})};OSF.DDA.BindingSelectionChangedEventArgs=function(c,a){OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.BindingSelectionChanged},binding:{value:c}});for(var b in a)OSF.OUtil.defineEnumerableProperty(this,b,{value:a[b]})};OSF.DDA.BindingDataChangedEventArgs=function(a){OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.BindingDataChanged},binding:{value:a}})};OSF.DDA.SettingsChangedEventArgs=function(a){OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.SettingsChanged},settings:{value:a}})};OSF.DDA.OfficeThemeChangedEventArgs=function(a){var b=OSF.DDA.ConvertToOfficeTheme(a);OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.Internal.EventType.OfficeThemeChanged},officeTheme:{value:b}})};OSF.DDA.DocumentThemeChangedEventArgs=function(a){var b=OSF.DDA.ConvertToDocumentTheme(a);OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.Internal.EventType.DocumentThemeChanged},documentTheme:{value:b}})};OSF.DDA.ActiveViewChangedEventArgs=function(a){OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.ActiveViewChanged},activeView:{value:a.activeView}})};OSF.O15HostSpecificFileVersion={GetFallbackVersion:function(d){var c="15.01",b={"1":"15.02","2":"15.02","4":"15.02","8":"15.04","16":"15.02","128":"15.02"},a=b[d];if(a)return a;else return c},GenerateVersion:function(d,c){var a=2;return b(d,a)+"."+b(c,a);function b(b,c){b=b||0;c=c||0;for(var a=b.toString(),e=c-a.length,d=0;d<e;d++)a="0"+a;return a}}};var OfficeExt;(function(b){var a=function(){function a(){}a.prototype.isMsAjaxLoaded=function(){if(typeof Sys!=="undefined"&&typeof Type!=="undefined"&&Sys.StringBuilder&&typeof Sys.StringBuilder==="function"&&Type.registerNamespace&&typeof Type.registerNamespace==="function"&&Type.registerClass&&typeof Type.registerClass==="function"&&typeof Function._validateParams==="function"&&Sys.Serialization&&Sys.Serialization.JavaScriptSerializer&&typeof Sys.Serialization.JavaScriptSerializer.serialize==="function")return true;else return false};a.prototype.loadMsAjaxFull=function(b){var a=(window.location.protocol.toLowerCase()==="https:"?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";OSF.OUtil.loadScript(a,b)};Object.defineProperty(a.prototype,"msAjaxError",{"get":function(){if(this._msAjaxError==null&&this.isMsAjaxLoaded())this._msAjaxError=Error;return this._msAjaxError},"set":function(a){this._msAjaxError=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"msAjaxSerializer",{"get":function(){if(this._msAjaxSerializer==null&&this.isMsAjaxLoaded())this._msAjaxSerializer=Sys.Serialization.JavaScriptSerializer;return this._msAjaxSerializer},"set":function(a){this._msAjaxSerializer=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"msAjaxString",{"get":function(){if(this._msAjaxString==null&&this.isMsAjaxLoaded())this._msAjaxSerializer=String;return this._msAjaxString},"set":function(a){this._msAjaxString=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"msAjaxDebug",{"get":function(){if(this._msAjaxDebug==null&&this.isMsAjaxLoaded())this._msAjaxDebug=Sys.Debug;return this._msAjaxDebug},"set":function(a){this._msAjaxDebug=a},enumerable:true,configurable:true});return a}();b.MicrosoftAjaxFactory=a})(OfficeExt||(OfficeExt={}));var OsfMsAjaxFactory=new OfficeExt.MicrosoftAjaxFactory;(function(c){var f=function(){function a(){}a.isInstanceOfType=function(c,b){if(typeof b==="undefined"||b===null)return false;if(b instanceof c)return true;var a=b.constructor;if(!a||typeof a!=="function"||!a.__typeName||a.__typeName==="Object")a=Object;return!!(a===c)||a.__typeName&&c.__typeName&&a.__typeName===c.__typeName};return a}();c.MsAjaxTypeHelper=f;var d=function(){function a(){}a.create=function(c,b){var a=new Error(c);a.message=c;if(b)for(var d in b)a[d]=b[d];a.popStackFrame();return a};a.parameterCount=function(b){var d="Sys.ParameterCountException: "+(b?b:"Parameter count mismatch."),c=a.create(d,{name:"Sys.ParameterCountException"});c.popStackFrame();return c};a.argument=function(c,e){var d="Sys.ArgumentException: "+(e?e:"Value does not fall within the expected range.");if(c)d+="\n"+b.format("Parameter name: {0}",c);var f=a.create(d,{name:"Sys.ArgumentException",paramName:c});f.popStackFrame();return f};a.argumentNull=function(c,e){var d="Sys.ArgumentNullException: "+(e?e:"Value cannot be null.");if(c)d+="\n"+b.format("Parameter name: {0}",c);var f=a.create(d,{name:"Sys.ArgumentNullException",paramName:c});f.popStackFrame();return f};a.argumentOutOfRange=function(e,c,f){var d="Sys.ArgumentOutOfRangeException: "+(f?f:"Specified argument was out of the range of valid values.");if(e)d+="\n"+b.format("Parameter name: {0}",e);if(typeof c!=="undefined"&&c!==null)d+="\n"+b.format("Actual value was {0}.",c);var g=a.create(d,{name:"Sys.ArgumentOutOfRangeException",paramName:e,actualValue:c});g.popStackFrame();return g};a.argumentType=function(f,e,d,g){var c="Sys.ArgumentTypeException: ";if(g)c+=g;else if(e&&d)c+=b.format("Object of type '{0}' cannot be converted to type '{1}'.",e.getName?e.getName():e,d.getName?d.getName():d);else c+="Object cannot be converted to the required type.";if(f)c+="\n"+b.format("Parameter name: {0}",f);var h=a.create(c,{name:"Sys.ArgumentTypeException",paramName:f,actualType:e,expectedType:d});h.popStackFrame();return h};a.argumentUndefined=function(c,e){var d="Sys.ArgumentUndefinedException: "+(e?e:"Value cannot be undefined.");if(c)d+="\n"+b.format("Parameter name: {0}",c);var f=a.create(d,{name:"Sys.ArgumentUndefinedException",paramName:c});f.popStackFrame();return f};a.invalidOperation=function(b){var d="Sys.InvalidOperationException: "+(b?b:"Operation is not valid due to the current state of the object."),c=a.create(d,{name:"Sys.InvalidOperationException"});c.popStackFrame();return c};return a}();c.MsAjaxError=d;var b=function(){function a(){}a.format=function(c){for(var b=[],a=1;a<arguments.length;a++)b[a-1]=arguments[a];var d=c;return d.replace(/{(\d+)}/gm,function(d,a){var c=parseInt(a,10);return b[c]===undefined?"{"+a+"}":b[c]})};a.startsWith=function(b,a){return b.substr(0,a.length)===a};return a}();c.MsAjaxString=b;var e=function(){function a(){}a.trace=function(a){typeof Debug!=="undefined"&&Debug.writeln;window.console&&window.console.log&&window.console.log(a);window.opera&&window.opera.postError&&window.opera.postError(a);window.debugService&&window.debugService.trace&&window.debugService.trace(a);var b=document.getElementById("TraceConsole");if(b&&b.tagName.toUpperCase()==="TEXTAREA")b.innerHTML+=a+"\n"};return a}();c.MsAjaxDebug=e;if(!OsfMsAjaxFactory.isMsAjaxLoaded()){var a=function(a,c,b){if(a.__typeName===undefined)a.__typeName=c;if(a.__class===undefined)a.__class=b};a(Function,"Function",true);a(Error,"Error",true);a(Object,"Object",true);a(String,"String",true);a(Boolean,"Boolean",true);a(Date,"Date",true);a(Number,"Number",true);a(RegExp,"RegExp",true);a(Array,"Array",true);if(!Function.createCallback)Function.createCallback=function(b,a){var c=Function._validateParams(arguments,[{name:"method",type:Function},{name:"context",mayBeNull:true}]);if(c)throw c;return function(){var e=arguments.length;if(e>0){for(var d=[],c=0;c<e;c++)d[c]=arguments[c];d[e]=a;return b.apply(this,d)}return b.call(this,a)}};if(!Function.createDelegate)Function.createDelegate=function(b,c){var a=Function._validateParams(arguments,[{name:"instance",mayBeNull:true},{name:"method",type:Function}]);if(a)throw a;return function(){return c.apply(b,arguments)}};if(!Function._validateParams)Function._validateParams=function(g,e,c){var a,d=e.length;c=c||typeof c==="undefined";a=Function._validateParameterCount(g,e,c);if(a){a.popStackFrame();return a}for(var b=0,i=g.length;b<i;b++){var f=e[Math.min(b,d-1)],h=f.name;if(f.parameterArray)h+="["+(b-d+1)+"]";else if(!c&&b>=d)break;a=Function._validateParameter(g[b],f,h);if(a){a.popStackFrame();return a}}return null};if(!Function._validateParameterCount)Function._validateParameterCount=function(k,e,j){var a,c,b=e.length,f=k.length;if(f<b){var g=b;for(a=0;a<b;a++){var h=e[a];if(h.optional||h.parameterArray)g--}if(f<g)c=true}else if(j&&f>b){c=true;for(a=0;a<b;a++)if(e[a].parameterArray){c=false;break}}if(c){var i=d.parameterCount();i.popStackFrame();return i}return null};if(!Function._validateParameter)Function._validateParameter=function(c,a,h){var b,g=a.type,l=!!a.integer,k=!!a.domElement,m=!!a.mayBeNull;b=Function._validateParameterType(c,g,l,k,m,h);if(b){b.popStackFrame();return b}var e=a.elementType,f=!!a.elementMayBeNull;if(g===Array&&typeof c!=="undefined"&&c!==null&&(e||!f))for(var j=!!a.elementInteger,i=!!a.elementDomElement,d=0;d<c.length;d++){var n=c[d];b=Function._validateParameterType(n,e,j,i,f,h+"["+d+"]");if(b){b.popStackFrame();return b}}return null};if(!Function._validateParameterType)Function._validateParameterType=function(b,d,h,g,f,e){var a,i;if(typeof b==="undefined")if(f)return null;else{a=c.MsAjaxError.argumentUndefined(e);a.popStackFrame();return a}if(b===null)if(f)return null;else{a=c.MsAjaxError.argumentNull(e);a.popStackFrame();return a}if(d&&!c.MsAjaxTypeHelper.isInstanceOfType(d,b)){a=c.MsAjaxError.argumentType(e,typeof b,d);a.popStackFrame();return a}return null};if(!window.Type)window.Type=Function;if(!Type.registerNamespace)Type.registerNamespace=function(d){for(var c=d.split("."),b=window,a=0;a<c.length;a++){b[c[a]]=b[c[a]]||{};b=b[c[a]]}};if(!Type.prototype.registerClass)Type.prototype.registerClass=function(a){a={}};typeof Sys==="undefined"&&Type.registerNamespace("Sys");if(!Error.prototype.popStackFrame)Error.prototype.popStackFrame=function(){if(arguments.length!==0)throw d.parameterCount();if(typeof this.stack==="undefined"||this.stack===null||typeof this.fileName==="undefined"||this.fileName===null||typeof this.lineNumber==="undefined"||this.lineNumber===null)return;var a=this.stack.split("\n"),c=a[0],f=this.fileName+":"+this.lineNumber;while(typeof c!=="undefined"&&c!==null&&c.indexOf(f)===-1){a.shift();c=a[0]}var e=a[1];if(typeof e==="undefined"||e===null)return;var b=e.match(/@(.*):(\d+)$/);if(typeof b==="undefined"||b===null)return;this.fileName=b[1];this.lineNumber=parseInt(b[2]);a.shift();this.stack=a.join("\n")};OsfMsAjaxFactory.msAjaxError=d;OsfMsAjaxFactory.msAjaxString=b;OsfMsAjaxFactory.msAjaxDebug=e}})(OfficeExt||(OfficeExt={}));var OfficeExt;(function(a){var b=function(){function b(){}b._init=function(){var d=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000b","\\f","\\r","\\u000e","\\u000f","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001a","\\u001b","\\u001c","\\u001d","\\u001e","\\u001f"];b._charsToEscape[0]="\\";b._charsToEscapeRegExs["\\"]=new RegExp("\\\\","g");b._escapeChars["\\"]="\\\\";b._charsToEscape[1]='"';b._charsToEscapeRegExs['"']=new RegExp('"',"g");b._escapeChars['"']='\\"';for(var a=0;a<32;a++){var c=String.fromCharCode(a);b._charsToEscape[a+2]=c;b._charsToEscapeRegExs[c]=new RegExp(c,"g");b._escapeChars[c]=d[a]}};b.serialize=function(d){var a=new c;b.serializeWithBuilder(d,a,false);return a.toString()};b.deserialize=function(c,e){if(c.length===0)throw a.MsAjaxError.argument("data","Cannot deserialize empty string.");try{var d=c.replace(b._dateRegEx,"$1new Date($2)");if(e&&b._jsonRegEx.test(d.replace(b._jsonStringRegEx,"")))throw null;return eval("("+d+")")}catch(f){throw a.MsAjaxError.argument("data","Cannot deserialize. The data does not correspond to valid JSON.");}};b.serializeBooleanWithBuilder=function(b,a){a.append(b.toString())};b.serializeNumberWithBuilder=function(b,c){if(isFinite(b))c.append(String(b));else throw a.MsAjaxError.invalidOperation("Cannot serialize non finite numbers.");};b.serializeStringWithBuilder=function(a,d){d.append('"');if(b._escapeRegEx.test(a)){b._charsToEscape.length===0&&b._init();if(a.length<128)a=a.replace(b._escapeRegExGlobal,function(a){return b._escapeChars[a]});else for(var e=0;e<34;e++){var c=b._charsToEscape[e];if(a.indexOf(c)!==-1)if(navigator.userAgent.indexOf("OPR/")>-1||navigator.userAgent.indexOf("Firefox")>-1)a=a.split(c).join(b._escapeChars[c]);else a=a.replace(b._charsToEscapeRegExs[c],b._escapeChars[c])}}d.append(a);d.append('"')};b.serializeWithBuilder=function(d,c,k,e){var f;switch(typeof d){case"object":if(d){if(e){for(var l=0;l<e.length;l++)if(e[l]===d)throw a.MsAjaxError.invalidOperation("Cannot serialize object with cyclic reference within child properties.");}else e=[];try{a.MsAjaxArray.add(e,d);if(a.MsAjaxTypeHelper.isInstanceOfType(Number,d))b.serializeNumberWithBuilder(d,c);else if(a.MsAjaxTypeHelper.isInstanceOfType(Boolean,d))b.serializeBooleanWithBuilder(d,c);else if(a.MsAjaxTypeHelper.isInstanceOfType(String,d))b.serializeStringWithBuilder(d,c);else if(a.MsAjaxTypeHelper.isInstanceOfType(Array,d)){c.append("[");for(f=0;f<d.length;++f){f>0&&c.append(",");b.serializeWithBuilder(d[f],c,false,e)}c.append("]")}else{if(a.MsAjaxTypeHelper.isInstanceOfType(Date,d)){c.append('"\\/Date(');c.append(d.getTime());c.append(')\\/"');break}var g=[],h=0;for(var i in d){if(a.MsAjaxString.startsWith(i,"$"))continue;if(i===b._serverTypeFieldName&&h!==0){g[h++]=g[0];g[0]=i}else g[h++]=i}k&&g.sort();c.append("{");var m=false;for(f=0;f<h;f++){var j=d[g[f]];if(typeof j!=="undefined"&&typeof j!=="function"){if(m)c.append(",");else m=true;b.serializeWithBuilder(g[f],c,k,e);c.append(":");b.serializeWithBuilder(j,c,k,e)}}c.append("}")}}finally{a.MsAjaxArray.removeAt(e,e.length-1)}}else c.append("null");break;case"number":b.serializeNumberWithBuilder(d,c);break;case"string":b.serializeStringWithBuilder(d,c);break;case"boolean":b.serializeBooleanWithBuilder(d,c);break;default:c.append("null");break}};b.__patchVersion=0;b._charsToEscapeRegExs=[];b._charsToEscape=[];b._dateRegEx=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',"g");b._escapeChars={};b._escapeRegEx=new RegExp('["\\\\\\x00-\\x1F]',"i");b._escapeRegExGlobal=new RegExp('["\\\\\\x00-\\x1F]',"g");b._jsonRegEx=new RegExp("[^,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]","g");b._jsonStringRegEx=new RegExp('"(\\\\.|[^"\\\\])*"',"g");b._serverTypeFieldName="__type";return b}();a.MsAjaxJavaScriptSerializer=b;var d=function(){function a(){}a.add=function(a,b){a[a.length]=b};a.removeAt=function(a,b){a.splice(b,1)};a.clone=function(a){if(a.length===1)return[a[0]];else return Array.apply(null,a)};a.remove=function(c,d){var b=a.indexOf(c,d);b>=0&&c.splice(b,1);return b>=0};a.indexOf=function(d,e,a){if(typeof e==="undefined")return-1;var c=d.length;if(c!==0){a=a-0;if(isNaN(a))a=0;else{if(isFinite(a))a=a-a%1;if(a<0)a=Math.max(0,c+a)}for(var b=a;b<c;b++)if(typeof d[b]!=="undefined"&&d[b]===e)return b}return-1};return a}();a.MsAjaxArray=d;var c=function(){function a(a){this._parts=typeof a!=="undefined"&&a!==null&&a!==""?[a.toString()]:[];this._value={};this._len=0}a.prototype.append=function(a){this._parts[this._parts.length]=a};a.prototype.toString=function(a){a=a||"";var b=this._parts;if(this._len!==b.length){this._value={};this._len=b.length}var d=this._value;if(typeof d[a]==="undefined"){if(a!=="")for(var c=0;c<b.length;)if(typeof b[c]==="undefined"||b[c]===""||b[c]===null)b.splice(c,1);else c++;d[a]=this._parts.join(a)}return d[a]};return a}();a.MsAjaxStringBuilder=c;if(!OsfMsAjaxFactory.isMsAjaxLoaded())OsfMsAjaxFactory.msAjaxSerializer=b})(OfficeExt||(OfficeExt={}));var OSF=OSF||{};OSF.OUtil=function(){var c=-1,f="&_xdm_Info=",e="_xdm_",a="#",b={},h=3e4,d=false;function g(){return Math.floor(100000001*Math.random()).toString()}return{extend:function(b,a){var c=function(){};c.prototype=a.prototype;b.prototype=new c;b.prototype.constructor=b;b.uber=a.prototype;if(a.prototype.constructor===Object.prototype.constructor)a.prototype.constructor=a},setNamespace:function(b,a){if(a&&b&&!a[b])a[b]={}},unsetNamespace:function(b,a){if(a&&b&&a[b])delete a[b]},loadScript:function(d,e,f){if(d&&e){var j=window.document,a=b[d];if(!a){var c=j.createElement("script");c.type="text/javascript";a={loaded:false,pendingCallbacks:[e],timer:null};b[d]=a;var g=function(){if(a.timer!=null){clearTimeout(a.timer);delete a.timer}a.loaded=true;for(var c=a.pendingCallbacks.length,b=0;b<c;b++){var d=a.pendingCallbacks.shift();d()}},i=function(){delete b[d];if(a.timer!=null){clearTimeout(a.timer);delete a.timer}for(var e=a.pendingCallbacks.length,c=0;c<e;c++){var f=a.pendingCallbacks.shift();f()}};if(c.readyState)c.onreadystatechange=function(){if(c.readyState=="loaded"||c.readyState=="complete"){c.onreadystatechange=null;g()}};else c.onload=g;c.onerror=i;f=f||h;a.timer=setTimeout(i,f);c.src=d;j.getElementsByTagName("head")[0].appendChild(c)}else if(a.loaded)e();else a.pendingCallbacks.push(e)}},loadCSS:function(c){if(c){var b=window.document,a=b.createElement("link");a.type="text/css";a.rel="stylesheet";a.href=c;b.getElementsByTagName("head")[0].appendChild(a)}},parseEnum:function(b,c){var a=c[b.trim()];if(typeof a=="undefined"){OsfMsAjaxFactory.msAjaxDebug.trace("invalid enumeration string:"+b);throw OsfMsAjaxFactory.msAjaxError.argument("str");}return a},delayExecutionAndCache:function(){var a={calc:arguments[0]};return function(){if(a.calc){a.val=a.calc.apply(this,arguments);delete a.calc}return a.val}},getUniqueId:function(){c=c+1;return c.toString()},formatString:function(){var a=arguments,b=a[0];return b.replace(/{(\d+)}/gm,function(d,b){var c=parseInt(b,10)+1;return a[c]===undefined?"{"+b+"}":a[c]})},generateConversationId:function(){return[g(),g(),(+new Date).toString()].join("_")},getFrameNameAndConversationId:function(b,c){var a=e+b+this.generateConversationId();c.setAttribute("name",a);return this.generateConversationId()},addXdmInfoAsHash:function(b,e){b=b.trim()||"";var c=b.split(a),d=c.shift(),g=c.join(a);return[d,a,g,f,e].join("")},parseXdmInfo:function(){var h=window.location.hash,c=h.split(f),a=c.length>1?c[c.length-1]:null;if(window.sessionStorage){var b=window.name.indexOf(e);if(b>-1){var d=window.name.indexOf(";",b);if(d==-1)d=window.name.length;var g=window.name.substring(b,d);if(a)window.sessionStorage.setItem(g,a);else a=window.sessionStorage.getItem(g)}}return a},getConversationId:function(){var b=window.location.search,a=null;if(b){var c=b.indexOf("&");a=c>0?b.substring(1,c):b.substr(1);if(a&&a.charAt(a.length-1)==="="){a=a.substring(0,a.length-1);if(a)a=decodeURIComponent(a)}}return a},validateParamObject:function(d,c,e){var a=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:false},{name:"expectedProperties",type:Object,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true}]);if(a)throw a;for(var b in c){a=Function._validateParameter(d[b],c[b],b);if(a)throw a;}},writeProfilerMark:function(a){if(window.msWriteProfilerMark){window.msWriteProfilerMark(a);OsfMsAjaxFactory.msAjaxDebug.trace(a)}},defineNondefaultProperty:function(d,e,a,b){a=a||{};for(var f in b){var c=b[f];if(a[c]==undefined)a[c]=true}Object.defineProperty(d,e,a);return d},defineNondefaultProperties:function(c,a,d){a=a||{};for(var b in a)OSF.OUtil.defineNondefaultProperty(c,b,a[b],d);return c},defineEnumerableProperty:function(c,b,a){return OSF.OUtil.defineNondefaultProperty(c,b,a,["enumerable"])},defineEnumerableProperties:function(b,a){return OSF.OUtil.defineNondefaultProperties(b,a,["enumerable"])},defineMutableProperty:function(c,b,a){return OSF.OUtil.defineNondefaultProperty(c,b,a,["writable","enumerable","configurable"])},defineMutableProperties:function(b,a){return OSF.OUtil.defineNondefaultProperties(b,a,["writable","enumerable","configurable"])},finalizeProperties:function(c,b){b=b||{};for(var e=Object.getOwnPropertyNames(c),g=e.length,d=0;d<g;d++){var f=e[d],a=Object.getOwnPropertyDescriptor(c,f);if(!a.get&&!a.set)a.writable=b.writable||false;a.configurable=b.configurable||false;a.enumerable=b.enumerable||true;Object.defineProperty(c,f,a)}return c},mapList:function(a,c){var b=[];if(a)for(var d in a)b.push(c(a[d]));return b},listContainsKey:function(b,c){for(var a in b)if(c==a)return true;return false},listContainsValue:function(a,b){for(var c in a)if(b==a[c])return true;return false},augmentList:function(a,b){var d=a.push?function(c,b){a.push(b)}:function(c,b){a[c]=b};for(var c in b)d(c,b[c])},redefineList:function(a,b){for(var d in a)delete a[d];for(var c in b)a[c]=b[c]},isArray:function(a){return Object.prototype.toString.apply(a)==="[object Array]"},isFunction:function(a){return Object.prototype.toString.apply(a)==="[object Function]"},isDate:function(a){return Object.prototype.toString.apply(a)==="[object Date]"},addEventListener:function(a,b,c){if(a.attachEvent)a.attachEvent("on"+b,c);else if(a.addEventListener)a.addEventListener(b,c,false);else a["on"+b]=c},removeEventListener:function(a,b,c){if(a.detachEvent)a.detachEvent("on"+b,c);else if(a.removeEventListener)a.removeEventListener(b,c,false);else a["on"+b]=null},encodeBase64:function(c){var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[],a=[],b=0,f,d,e,i=c.length;do{f=c[b++];d=c[b++];e=c[b++];a[0]=f>>2;a[1]=(f&3)<<4|d>>4;a[2]=(d&15)<<2|e>>6;a[3]=e&63;if(isNaN(d))a[2]=a[3]=64;else if(isNaN(e))a[3]=64;for(var g=0;g<4;g++)h.push(j.charAt(a[g]))}while(b<i);return h.join("")},getLocalStorage:function(){var a=null;if(!d)try{if(window.localStorage)a=window.localStorage}catch(b){d=true}return a},splitStringToList:function(h,f){for(var c=false,g=-1,e=[],d=false,b=f+h,a=0;a<b.length;a++)if(b[a]=="\\"&&!c)c=true;else{if(b[a]==f&&!d){e.push("");g++}else if(b[a]=='"'&&!c)d=!d;else e[g]+=b[a];c=false}return e},convertIntToHex:function(b){var a="#"+(Number(b)+16777216).toString(16).slice(-6);return a}}}();OSF.OUtil.Guid=function(){var a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{generateNewGuid:function(){for(var c="",d=+new Date,b=0;b<32&&d>0;b++){if(b==8||b==12||b==16||b==20)c+="-";c+=a[d%16];d=Math.floor(d/16)}for(;b<32;b++){if(b==8||b==12||b==16||b==20)c+="-";c+=a[Math.floor(Math.random()*16)]}return c}}}();window.OSF=OSF;AriaLogger=function(){var a=null,b,t=true,s=true,g={name:"AppActivated",enabled:true,basic:true,critical:true,points:[{name:"Browser",type:"string"},{name:"Message",type:"string"},{name:"AppId",type:"string"},{name:"AppURL",type:"string"},{name:"UserId",type:"string"},{name:"Host",type:"string"},{name:"HostVersion",type:"string"},{name:"CorrelationId",type:"string",rename:"HostSessionId"},{name:"AppSizeWidth",type:"int64"},{name:"AppSizeHeight",type:"int64"},{name:"AppInstanceId",type:"string"},{name:"OfficeJSVersion",type:"string"},{name:"HostJSVersion",type:"string"},{name:"IsFromWacAutomation",type:"string"}]},h={name:"ScriptLoad",enabled:true,basic:false,critical:false,points:[{name:"ScriptId",type:"string"},{name:"StartTime",type:"double"},{name:"ResponseTime",type:"double"}]},l={name:"APIUsage",enabled:false,basic:false,critical:false,points:[{name:"APIType",type:"string"},{name:"APIID",type:"int64"},{name:"Parameters",type:"string"},{name:"ResponseTime",type:"int64"},{name:"ErrorType",type:"int64"}]},f={name:"AppInitialization",enabled:true,basic:false,critical:false,points:[{name:"SuccessCode",type:"int64"},{name:"Message",type:"string"}]},i={name:"AppClosed",enabled:true,basic:false,critical:false,points:[{name:"FocusTime",type:"int64"},{name:"AppSizeFinalWidth",type:"int64"},{name:"AppSizeFinalHeight",type:"int64"},{name:"OpenTime",type:"int64"}]},e=[g,h,l,f,i];function n(a,c){var d=c.rename===undefined?c.name:c.rename,e=c.type,b=undefined;switch(e){case"string":b=oteljs.makeStringDataField(d,a);break;case"double":if(typeof a==="string")a=parseFloat(a);b=oteljs.makeDoubleDataField(d,a);break;case"int64":if(typeof a==="string")a=parseInt(a);b=oteljs.makeInt64DataField(d,a);break;case"boolean":if(typeof a==="string")a=a==="true";b=oteljs.makeBooleanDataField(d,a);break}return b}function d(c){for(var a=0;a<e.length;a++){var b=e[a];if(b.name===c)return b}return undefined}function q(b){var a=d(b);if(a===undefined)return false;return a.enabled}function j(f,l){var a=d(f);if(a===undefined)return undefined;for(var e=[],c=0,j=a.points;c<j.length;c++){var h=j[c],o=h.name,i=l[o];if(i===undefined)continue;var g=n(i,h);g!==undefined&&e.push(g)}var b={dataCategories:oteljs.DataCategories.ProductServiceUsage};if(a.critical)b.samplingPolicy=oteljs.SamplingPolicy.CriticalBusinessImpact;if(a.basic)b.diagnosticLevel=oteljs.DiagnosticLevel.BasicEvent;var k="Office.Extensibility.OfficeJs."+f+"XZ",m={eventName:k,dataFields:e,eventFlags:b};return m}function k(a,b){if(q(a))if(typeof OTel!=="undefined")OTel.OTelLogger.onTelemetryLoaded(function(){var c=j(a,b);if(c===undefined)return;Microsoft.Office.WebExtension.sendTelemetryEvent(c)})}function p(a){return a.Fields!==undefined}function o(b,c){var d,a;b=b.toLowerCase();c=c.toLowerCase();a=b.indexOf(c);if(a>=0&&a===b.length-c.length&&(a===0||b.charAt(a-1)==="/"||b.charAt(a-1)==="\\"))d=b.substring(0,a);return d}function r(){if(a)return a;else{for(var e=document.getElementsByTagName("script")||[],h=e.length,f=["office.js","office.debug.js"],g=f.length,d,b,c=0;!b&&c<h;c++)if(e[c].src)for(d=0;!b&&d<g;d++)b=o(e[c].src,f[d]);a=b;return a}}function m(){return r()+"ariatelemetry/aria-web-telemetry.js"}function c(c,a){var d=1e3;this.EnableSendingTelemetryWithLegacyAria&&OSF.OUtil.loadScript(m(),function(){try{if(!b){var f="db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439";b=AWTLogManager.initialize(f)}var d=new AWTEventProperties;d.setName("Office.Extensibility.OfficeJS."+c);for(var e in a)e.toLowerCase()!=="table"&&d.setProperty(e,a[e]);var g=new Date;d.setProperty("Date",g.toISOString());b.logEvent(d)}catch(h){}},d);this.EnableSendingTelemetryWithOTel&&k(c,a)}return{logData:function(a){if(p(a))c(a.Table,a.Fields);else c(a.Table,a)},EnableSendingTelemetryWithLegacyAria:true,EnableSendingTelemetryWithOTel:true}}();var __extends=this.__extends||function(b,c){function a(){this.constructor=b}a.prototype=c.prototype;b.prototype=new a},OSFLog;(function(b){var a=function(){function a(a){this._table=a;this._fields={}}Object.defineProperty(a.prototype,"Fields",{"get":function(){return this._fields},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"Table",{"get":function(){return this._table},enumerable:true,configurable:true});a.prototype.SerializeFields=function(){};a.prototype.SetSerializedField=function(b,a){if(typeof a!=="undefined"&&a!==null)this._serializedFields[b]=a.toString()};a.prototype.SerializeRow=function(){this._serializedFields={};this.SetSerializedField("Table",this._table);this.SerializeFields();return JSON.stringify(this._serializedFields)};return a}();b.BaseUsageData=a;var d=function(b){__extends(a,b);function a(){b.call(this,"AppActivated")}Object.defineProperty(a.prototype,"CorrelationId",{"get":function(){return this.Fields.CorrelationId},"set":function(a){this.Fields.CorrelationId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"SessionId",{"get":function(){return this.Fields.SessionId},"set":function(a){this.Fields.SessionId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"AppId",{"get":function(){return this.Fields.AppId},"set":function(a){this.Fields.AppId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"AppInstanceId",{"get":function(){return this.Fields.AppInstanceId},"set":function(a){this.Fields.AppInstanceId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"AppURL",{"get":function(){return this.Fields.AppURL},"set":function(a){this.Fields.AppURL=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"AssetId",{"get":function(){return this.Fields.AssetId},"set":function(a){this.Fields.AssetId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"Browser",{"get":function(){return this.Fields.Browser},"set":function(a){this.Fields.Browser=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"UserId",{"get":function(){return this.Fields.UserId},"set":function(a){this.Fields.UserId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"Host",{"get":function(){return this.Fields.Host},"set":function(a){this.Fields.Host=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"HostVersion",{"get":function(){return this.Fields.HostVersion},"set":function(a){this.Fields.HostVersion=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"ClientId",{"get":function(){return this.Fields.ClientId},"set":function(a){this.Fields.ClientId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"AppSizeWidth",{"get":function(){return this.Fields.AppSizeWidth},"set":function(a){this.Fields.AppSizeWidth=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"AppSizeHeight",{"get":function(){return this.Fields.AppSizeHeight},"set":function(a){this.Fields.AppSizeHeight=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"DocUrl",{"get":function(){return this.Fields.DocUrl},"set":function(a){this.Fields.DocUrl=a},enumerable:true,configurable:true});a.prototype.SerializeFields=function(){this.SetSerializedField("CorrelationId",this.CorrelationId);this.SetSerializedField("SessionId",this.SessionId);this.SetSerializedField("AppId",this.AppId);this.SetSerializedField("AppInstanceId",this.AppInstanceId);this.SetSerializedField("AppURL",this.AppURL);this.SetSerializedField("AssetId",this.AssetId);this.SetSerializedField("Browser",this.Browser);this.SetSerializedField("UserId",this.UserId);this.SetSerializedField("Host",this.Host);this.SetSerializedField("HostVersion",this.HostVersion);this.SetSerializedField("ClientId",this.ClientId);this.SetSerializedField("AppSizeWidth",this.AppSizeWidth);this.SetSerializedField("AppSizeHeight",this.AppSizeHeight);this.SetSerializedField("DocUrl",this.DocUrl)};return a}(a);b.AppActivatedUsageData=d;var e=function(b){__extends(a,b);function a(){b.call(this,"ScriptLoad")}Object.defineProperty(a.prototype,"CorrelationId",{"get":function(){return this.Fields.CorrelationId},"set":function(a){this.Fields.CorrelationId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"SessionId",{"get":function(){return this.Fields.SessionId},"set":function(a){this.Fields.SessionId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"ScriptId",{"get":function(){return this.Fields.ScriptId},"set":function(a){this.Fields.ScriptId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"StartTime",{"get":function(){return this.Fields.StartTime},"set":function(a){this.Fields.StartTime=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"ResponseTime",{"get":function(){return this.Fields.ResponseTime},"set":function(a){this.Fields.ResponseTime=a},enumerable:true,configurable:true});a.prototype.SerializeFields=function(){this.SetSerializedField("CorrelationId",this.CorrelationId);this.SetSerializedField("SessionId",this.SessionId);this.SetSerializedField("ScriptId",this.ScriptId);this.SetSerializedField("StartTime",this.StartTime);this.SetSerializedField("ResponseTime",this.ResponseTime)};return a}(a);b.ScriptLoadUsageData=e;var f=function(b){__extends(a,b);function a(){b.call(this,"AppClosed")}Object.defineProperty(a.prototype,"CorrelationId",{"get":function(){return this.Fields.CorrelationId},"set":function(a){this.Fields.CorrelationId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"SessionId",{"get":function(){return this.Fields.SessionId},"set":function(a){this.Fields.SessionId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"FocusTime",{"get":function(){return this.Fields.FocusTime},"set":function(a){this.Fields.FocusTime=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"AppSizeFinalWidth",{"get":function(){return this.Fields.AppSizeFinalWidth},"set":function(a){this.Fields.AppSizeFinalWidth=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"AppSizeFinalHeight",{"get":function(){return this.Fields.AppSizeFinalHeight},"set":function(a){this.Fields.AppSizeFinalHeight=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"OpenTime",{"get":function(){return this.Fields.OpenTime},"set":function(a){this.Fields.OpenTime=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"CloseMethod",{"get":function(){return this.Fields.CloseMethod},"set":function(a){this.Fields.CloseMethod=a},enumerable:true,configurable:true});a.prototype.SerializeFields=function(){this.SetSerializedField("CorrelationId",this.CorrelationId);this.SetSerializedField("SessionId",this.SessionId);this.SetSerializedField("FocusTime",this.FocusTime);this.SetSerializedField("AppSizeFinalWidth",this.AppSizeFinalWidth);this.SetSerializedField("AppSizeFinalHeight",this.AppSizeFinalHeight);this.SetSerializedField("OpenTime",this.OpenTime);this.SetSerializedField("CloseMethod",this.CloseMethod)};return a}(a);b.AppClosedUsageData=f;var g=function(b){__extends(a,b);function a(){b.call(this,"APIUsage")}Object.defineProperty(a.prototype,"CorrelationId",{"get":function(){return this.Fields.CorrelationId},"set":function(a){this.Fields.CorrelationId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"SessionId",{"get":function(){return this.Fields.SessionId},"set":function(a){this.Fields.SessionId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"APIType",{"get":function(){return this.Fields.APIType},"set":function(a){this.Fields.APIType=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"APIID",{"get":function(){return this.Fields.APIID},"set":function(a){this.Fields.APIID=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"Parameters",{"get":function(){return this.Fields.Parameters},"set":function(a){this.Fields.Parameters=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"ResponseTime",{"get":function(){return this.Fields.ResponseTime},"set":function(a){this.Fields.ResponseTime=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"ErrorType",{"get":function(){return this.Fields.ErrorType},"set":function(a){this.Fields.ErrorType=a},enumerable:true,configurable:true});a.prototype.SerializeFields=function(){this.SetSerializedField("CorrelationId",this.CorrelationId);this.SetSerializedField("SessionId",this.SessionId);this.SetSerializedField("APIType",this.APIType);this.SetSerializedField("APIID",this.APIID);this.SetSerializedField("Parameters",this.Parameters);this.SetSerializedField("ResponseTime",this.ResponseTime);this.SetSerializedField("ErrorType",this.ErrorType)};return a}(a);b.APIUsageUsageData=g;var c=function(b){__extends(a,b);function a(){b.call(this,"AppInitialization")}Object.defineProperty(a.prototype,"CorrelationId",{"get":function(){return this.Fields.CorrelationId},"set":function(a){this.Fields.CorrelationId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"SessionId",{"get":function(){return this.Fields.SessionId},"set":function(a){this.Fields.SessionId=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"SuccessCode",{"get":function(){return this.Fields.SuccessCode},"set":function(a){this.Fields.SuccessCode=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"Message",{"get":function(){return this.Fields.Message},"set":function(a){this.Fields.Message=a},enumerable:true,configurable:true});a.prototype.SerializeFields=function(){this.SetSerializedField("CorrelationId",this.CorrelationId);this.SetSerializedField("SessionId",this.SessionId);this.SetSerializedField("SuccessCode",this.SuccessCode);this.SetSerializedField("Message",this.Message)};return a}(a);b.AppInitializationUsageData=c})(OSFLog||(OSFLog={}));var Logger;(function(a){"use strict";(function(a){a[a.info=0]="info";a[a.warning=1]="warning";a[a.error=2]="error"})(a.TraceLevel||(a.TraceLevel={}));var f=a.TraceLevel;(function(a){a[a.none=0]="none";a[a.flush=1]="flush"})(a.SendFlag||(a.SendFlag={}));var g=a.SendFlag;function b(){OSF.Logger&&OSF.Logger.ulsEndpoint&&OSF.Logger.ulsEndpoint.loadProxyFrame()}a.allowUploadingData=b;function e(a,c,d){if(OSF.Logger&&OSF.Logger.ulsEndpoint){var b={traceLevel:a,message:c,flag:d,internalLog:true},e=JSON.stringify(b);OSF.Logger.ulsEndpoint.writeLog(e)}}a.sendLog=e;function c(){try{return new d}catch(a){return null}}var d=function(){function a(){var a=this;this.proxyFrame=null;this.telemetryEndPoint="https://telemetryservice.firstpartyapps.oaspapps.com/telemetryservice/telemetryproxy.html";this.buffer=[];this.proxyFrameReady=false;OSF.OUtil.addEventListener(window,"message",function(b){return a.tellProxyFrameReady(b)});setTimeout(function(){a.loadProxyFrame()},3e3)}a.prototype.writeLog=function(a){if(this.proxyFrameReady===true)this.proxyFrame.contentWindow.postMessage(a,"*");else this.buffer.length<128&&this.buffer.push(a)};a.prototype.loadProxyFrame=function(){if(this.proxyFrame==null){this.proxyFrame=document.createElement("iframe");this.proxyFrame.setAttribute("style","display:none");this.proxyFrame.setAttribute("src",this.telemetryEndPoint);document.head.appendChild(this.proxyFrame)}};a.prototype.tellProxyFrameReady=function(b){var e=this;if(b.data==="ProxyFrameReadyToLog"){this.proxyFrameReady=true;for(var a=0;a<this.buffer.length;a++)this.writeLog(this.buffer[a]);this.buffer.length=0;OSF.OUtil.removeEventListener(window,"message",function(a){return e.tellProxyFrameReady(a)})}else if(b.data==="ProxyFrameReadyToInit"){var c={appName:"Office APPs",sessionId:OSF.OUtil.Guid.generateNewGuid()},d=JSON.stringify(c);this.proxyFrame.contentWindow.postMessage(d,"*")}};return a}();if(!OSF.Logger)OSF.Logger=a;a.ulsEndpoint=c()})(Logger||(Logger={}));var OSFAppTelemetry;(function(b){"use strict";var a,c=OSF.OUtil.Guid.generateNewGuid(),f="",v=function(){function a(){}return a}(),d=function(){function a(b,a){this.name=b;this.handler=a}return a}(),h=function(){function a(){this.clientIDKey="Office API client";this.logIdSetKey="Office App Log Id Set"}a.prototype.getClientId=function(){var a=this.getValue(this.clientIDKey);if(!a||a.length<=0||a.length>40){a=OSF.OUtil.Guid.generateNewGuid();this.setValue(this.clientIDKey,a)}return a};a.prototype.saveLog=function(b,c){var a=this.getValue(this.logIdSetKey);a=(a&&a.length>0?a+";":"")+b;this.setValue(this.logIdSetKey,a);this.setValue(b,c)};a.prototype.enumerateLog=function(b,d){var c=this.getValue(this.logIdSetKey);if(c){var e=c.split(";");for(var g in e){var a=e[g],f=this.getValue(a);if(f){b&&b(a,f);d&&this.remove(a)}}d&&this.remove(this.logIdSetKey)}};a.prototype.getValue=function(c){var a=OSF.OUtil.getLocalStorage(),b="";if(a)b=a.getItem(c);return b};a.prototype.setValue=function(c,b){var a=OSF.OUtil.getLocalStorage();a&&a.setItem(c,b)};a.prototype.remove=function(b){var a=OSF.OUtil.getLocalStorage();if(a)try{a.removeItem(b)}catch(c){}};return a}(),e=function(){function a(){}a.prototype.LogData=function(a){if(!OSF.Logger)return;try{AriaLogger.logData(a)}catch(b){}};a.prototype.LogRawData=function(a){if(!OSF.Logger)return;try{AriaLogger.logData(JSON.parse(a))}catch(b){}};return a}(),u=function(){function a(){}a.hashString=function(c){var a=0;if(c.length===0)return a;for(var b=0;b<c.length;b++){var d=c.charCodeAt(b);a=(a<<5)-a+d;a|=0}return a};a.stringToHash=function(d){var c=a.hashString(d),b=c.toString();if(c<0)b="1"+b.substring(1);else b="0"+b;return b};a.startsWith=function(b,a){return b.indexOf(a)==-0};a.isFileUrl=function(b){return a.startsWith(b.toLowerCase(),"file:")};a.removeHttpPrefix=function(c){var b="";if(a.startsWith(c.toLowerCase(),a.httpsPrefix))b=a.httpsPrefix;else if(a.startsWith(c.toLowerCase(),a.httpPrefix))b=a.httpPrefix;var d=c.slice(b.length);return d};a.getUrlDomain=function(c){var b=a.removeHttpPrefix(c);b=b.split("/")[0];b=b.split(":")[0];return b};a.isIp4Address=function(b){var a=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;return a.test(b)};a.filter=function(d){if(a.isFileUrl(d)){var c=a.stringToHash(d);return"file://"+c}var b=a.getUrlDomain(d);if(a.isIp4Address(b)){var c=a.stringToHash(d);if(a.startsWith(b,"10."))return"IP10Range_"+c;else if(a.startsWith(b,"192."))return"IP192Range_"+c;else if(a.startsWith(b,"127."))return"IP127Range_"+c;return"IPOther_"+c}return b};a.httpPrefix="http://";a.httpsPrefix="https://";return a}();function s(c){if(!OSF.Logger)return;if(a)return;a=new v;a.hostVersion=c.get_appVersion();a.appId=c.get_id();a.host=c.get_appName();a.browser=window.navigator.userAgent;a.correlationId=c.get_correlationId();a.clientId=(new h).getClientId();a.appInstanceId=c.get_appInstanceId();if(a.appInstanceId)a.appInstanceId=a.appInstanceId.replace(/[{}]/g,"").toLowerCase();var g=new RegExp("^https?://store\\.office(ppe|-int)?\\.com/","i"),f=c.get_docUrl();a.docUrl=g.test(f)?f:"";var e=location.href;if(e)e=e.split("?")[0].split("#")[0];a.appURL=u.filter(e);(function(e,a){var c,d,b;a.assetId="";a.userId="";try{c=decodeURIComponent(e);d=new DOMParser;b=d.parseFromString(c,"text/xml");a.userId=b.getElementsByTagName("t")[0].attributes.getNamedItem("cid").nodeValue;a.assetId=b.getElementsByTagName("t")[0].attributes.getNamedItem("aid").nodeValue}catch(f){}finally{c=null;b=null;d=null}})(c.get_eToken(),a);typeof OTel!=="undefined"&&OTel.OTelLogger.initialize(a);(function(){var j=new Date,c=null,g=0,i=false,e=function(){if(document.hasFocus()){if(c==null)c=new Date}else if(c){g+=Math.abs(+new Date-c.getTime());c=null}},a=[];a.push(new d("focus",e));a.push(new d("blur",e));a.push(new d("focusout",e));a.push(new d("focusin",e));var h=function(){for(var d=0;d<a.length;d++)OSF.OUtil.removeEventListener(window,a[d].name,a[d].handler);a.length=0;if(!i){if(document.hasFocus()&&c){g+=Math.abs(+new Date-c.getTime());c=null}b.onAppClosed(Math.abs(+new Date-j.getTime()),g);i=true}};a.push(new d("beforeunload",h));a.push(new d("unload",h));for(var f=0;f<a.length;f++)OSF.OUtil.addEventListener(window,a[f].name,a[f].handler);e()})();b.onAppActivated()}b.initialize=s;function l(){if(!a)return;(new h).enumerateLog(function(b,a){return(new e).LogRawData(a)},true);var b=new OSFLog.AppActivatedUsageData;b.SessionId=c;b.AppId=a.appId;b.AssetId=a.assetId;b.AppURL=a.appURL;b.UserId=a.userId;b.ClientId=a.clientId;b.Browser=a.browser;b.Host=a.host;b.HostVersion=a.hostVersion;b.CorrelationId=a.correlationId;b.AppSizeWidth=window.innerWidth;b.AppSizeHeight=window.innerHeight;b.AppInstanceId=a.appInstanceId;b.DocUrl=a.docUrl;(new e).LogData(b);setTimeout(function(){if(!OSF.Logger)return;OSF.Logger.allowUploadingData()},100)}b.onAppActivated=l;function p(g,f,d,b){var a=new OSFLog.ScriptLoadUsageData;a.CorrelationId=b;a.SessionId=c;a.ScriptId=g;a.StartTime=f;a.ResponseTime=d;(new e).LogData(a)}b.onScriptDone=p;function t(i,j,g,d,h){if(!a)return;var b=new OSFLog.APIUsageUsageData;b.CorrelationId=f;b.SessionId=c;b.APIType=i;b.APIID=j;b.Parameters=g;b.ResponseTime=d;b.ErrorType=h;(new e).LogData(b)}b.onCallDone=t;function o(f,b,d,e){var a=null;if(b)if(typeof b=="number")a=String(b);else if(typeof b==="object")for(var c in b){if(a!==null)a+=",";else a="";if(typeof b[c]=="number")a+=String(b[c])}else a="";OSF.AppTelemetry.onCallDone("method",f,a,d,e)}b.onMethodDone=o;function m(b,a){OSF.AppTelemetry.onCallDone("property",-1,b,a)}b.onPropertyDone=m;function r(b,a){OSF.AppTelemetry.onCallDone("event",b,null,0,a)}b.onEventDone=r;function n(c,d,a,b){OSF.AppTelemetry.onCallDone(c?"registerevent":"unregisterevent",d,null,a,b)}b.onRegisterDone=n;function q(e,d){if(!a)return;var b=new OSFLog.AppClosedUsageData;b.CorrelationId=f;b.SessionId=c;b.FocusTime=d;b.OpenTime=e;b.AppSizeFinalWidth=window.innerWidth;b.AppSizeFinalHeight=window.innerHeight;(new h).saveLog(c,b.SerializeRow())}b.onAppClosed=q;function i(a){f=a}b.setOsfControlAppCorrelationId=i;function g(b,d){var a=new OSFLog.AppInitializationUsageData;a.CorrelationId=f;a.SessionId=c;a.SuccessCode=b?1:0;a.Message=d;(new e).LogData(a)}b.doAppInitializationLogging=g;function j(a){g(false,a)}b.logAppCommonMessage=j;function k(a){g(true,a)}b.logAppException=k;OSF.AppTelemetry=b})(OSFAppTelemetry||(OSFAppTelemetry={}));OSF.InitializationHelper=function(c,a,e,d,b){this._hostInfo=c;this._webAppState=a;this._context=e;this._settings=d;this._hostFacade=b};OSF.InitializationHelper.prototype.getAppContext=function(B,l){if(this._hostInfo.isRichClient){var c,a,r="Warning: Office.js is loaded outside of Office client",f=function(){OsfMsAjaxFactory.msAjaxDebug.trace(r);Microsoft.Office.WebExtension.browserInitialize&&Microsoft.Office.WebExtension.browserInitialize(Microsoft.Office.WebExtension.InitializationReason.Browser)};try{if(window.external&&typeof window.external.GetContext!=="undefined")a=OSF.DDA._OsfControlContext=window.external.GetContext();else{f();return}}catch(D){f();return}var a=window.external.GetContext(),d=a.GetAppType(),h=false;for(var u in OSF.AppName)if(OSF.AppName[u]==d){h=true;break}if(!h)throw"Unsupported client type "+d;var A=a.GetSolutionRef(),i;if(typeof a.GetApiSetVersion!=="undefined")i=a.GetApiSetVersion();var x=OSF.O15HostSpecificFileVersion.GenerateVersion(a.GetAppVersionMajor(),i),o=a.GetAppVersionMinor(),w=a.GetAppUILocale(),t=a.GetAppDataLocale(),y=a.GetDocUrl(),s=a.GetAppCapabilities(),z=a.GetActivationMode(),n=a.GetControlIntegrationLevel(),v=[],b;try{b=a.GetSolutionToken()}catch(C){}var k;if(typeof a.GetCorrelationId!=="undefined")k=a.GetCorrelationId();var g;if(typeof a.GetSupportedMatrix!=="undefined")g=a.GetSupportedMatrix();b=b?b.toString():"";var j;if(typeof a.GetInstanceId!=="undefined")j=a.GetInstanceId();var e;if(typeof a.GetDialogRequirementMatrix!="undefined")e=a.GetDialogRequirementMatrix();c=new OSF.OfficeAppContext(A,d,x,w,t,y,s,v,z,n,b,k,j,0,0,o,g,e);try{var p=window.external.GetHostInfo(),q=p.indexOf("isDialog")!=-1;this._hostInfo.isDialog=q}catch(D){}l(c);OSF.AppTelemetry&&OSF.AppTelemetry.initialize(c)}else{var m=function(g,a){var b;if(a._appName===OSF.AppName.ExcelWebApp){var c=a._settings;b={};for(var i in c){var h=c[i];b[h[0]]=h[1]}}else b=a._settings;if(g===0&&a._id!=undefined&&a._appName!=undefined&&a._appVersion!=undefined&&a._appUILocale!=undefined&&a._dataLocale!=undefined&&a._docUrl!=undefined&&a._clientMode!=undefined&&a._settings!=undefined&&a._reason!=undefined){var f=0;if(a._appMinorVersion!=undefined)f=a._appMinorVersion;var d=undefined;if(a._requirementMatrix!=undefined)d=a._requirementMatrix;var e=new OSF.OfficeAppContext(a._id,a._appName,a._appVersion,a._appUILocale,a._dataLocale,a._docUrl,a._clientMode,b,a._reason,a._osfControlType,a._eToken,a._correlationId,0,0,0,f,d);l(e);OSF.AppTelemetry&&OSF.AppTelemetry.initialize(e)}else throw"Function ContextActivationManager_getAppContextAsync call failed. ErrorCode is "+g;};this._webAppState.clientEndPoint.invoke("ContextActivationManager_getAppContextAsync",m,this._webAppState.id)}};OSF.InitializationHelper.prototype.setAgaveHostCommunication=function(){var a=this,c=OSF.OUtil.parseXdmInfo();if(c){a._hostInfo.isRichClient=false;var b=c.split("|");if(b==undefined||typeof b[1]=="undefined")b=c.split("%7C");if(b!=undefined&&b.length>=3){a._webAppState.conversationID=b[0];a._webAppState.id=b[1];a._webAppState.webAppUrl=b[2]}}else a._hostInfo.isRichClient=true;if(!a._hostInfo.isRichClient){a._webAppState.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(a._webAppState.conversationID,a._webAppState.wnd,a._webAppState.webAppUrl);a._webAppState.serviceEndPoint=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(a._webAppState.id);var d=a._webAppState.conversationID+OSF.SharedConstants.NotificationConversationIdSuffix;a._webAppState.serviceEndPoint.registerConversation(d);var e=function(b){switch(b){case OSF.AgaveHostAction.Select:a._webAppState.focused=true;window.focus();break;case OSF.AgaveHostAction.UnSelect:a._webAppState.focused=false;break;default:OsfMsAjaxFactory.msAjaxDebug.trace("actionId "+b+" notifyAgave is wrong.");break}};a._webAppState.serviceEndPoint.registerMethod("Office_notifyAgave",e,Microsoft.Office.Common.InvokeType.async,false);window.onfocus=function(){if(!a._webAppState.focused){a._webAppState.focused=true;a._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[a._webAppState.id,OSF.AgaveHostAction.Select])}};window.onblur=function(){if(a._webAppState.focused){a._webAppState.focused=false;a._webAppState.clientEndPoint.invoke("ContextActivationManager_notifyHost",null,[a._webAppState.id,OSF.AgaveHostAction.UnSelect])}}}};OSF.InitializationHelper.prototype.prepareRightBeforeWebExtensionInitialize=function(a){var e=new OSF.DDA.License(a.get_eToken()),j=window.open;window.open=function(d,c,b){var a=null;try{a=j(d,c,b)}catch(f){}if(!a&&OSF._OfficeAppFactory.getClientEndPoint()&&OSF._OfficeAppFactory.getClientEndPoint().invoke){var e={strUrl:d,strWindowName:c,strWindowFeatures:b};OSF._OfficeAppFactory.getClientEndPoint().invoke("ContextActivationManager_openWindowInHost",null,e)}return a};if(this._hostInfo.isRichClient){var g=true;try{g=a.get_appName()==OSF.AppName.Outlook&&parseFloat(a.get_appVersion())<15.04}catch(k){}if(!g)if(a.get_isDialog()){if(OSF.DDA.UI.ChildUI)a.ui=new OSF.DDA.UI.ChildUI}else if(OSF.DDA.UI.ParentUI)a.ui=new OSF.DDA.UI.ParentUI;if(OSF.DDA.SafeArray!=undefined){var b=OSF.DDA.SafeArray.Delegate.ParameterMap,c={};c[OSF.DDA.EventDescriptors.DialogMessageReceivedEvent]=OSF.DDA.SafeArray.Delegate.ParameterMap.self;b.setMapping(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,{fromHost:c});c={};c[OSF.DDA.PropertyDescriptors.MessageType]=0;c[OSF.DDA.PropertyDescriptors.MessageContent]=1;b.setMapping(OSF.DDA.EventDescriptors.DialogMessageReceivedEvent,{fromHost:c});OSF.DDA.SafeArray.Delegate.ParameterMap=b}}if(a.get_appName()==OSF.AppName.OutlookWebApp){OSF._OfficeAppFactory.setContext(new OSF.DDA.OutlookContext(a,this._settings,e,a.appOM));Microsoft.Office.WebExtension.initialize()}else if(a.get_appName()==OSF.AppName.Outlook){OSF._OfficeAppFactory.setContext(new OSF.DDA.OutlookContext(a,this._settings,e,a.appOM));if(typeof OfficeJsClient_OutlookWin32!=="undefined")if(typeof OfficeJsClient_OutlookWin32.prepareRightAfterWebExtensionInitialize!=="undefined"){OfficeJsClient_OutlookWin32.prepareRightBeforeWebExtensionInitialize();Microsoft.Office.WebExtension.initialize();OfficeJsClient_OutlookWin32.prepareRightAfterWebExtensionInitialize()}else{Microsoft.Office.WebExtension.initialize();OfficeJsClient_OutlookWin32.prepareRightBeforeWebExtensionInitialize()}else Microsoft.Office.WebExtension.initialize()}else if(a.get_osfControlType()===OSF.OsfControlType.DocumentLevel||a.get_osfControlType()===OSF.OsfControlType.ContainerLevel){OSF._OfficeAppFactory.setContext(new OSF.DDA.Context(a,a.doc,e));var d,b,f=a.get_reason();if(this._hostInfo.isRichClient){function h(a){try{a.onCalling&&a.onCalling();var d=+new Date,e=a.hostCallArgs[Microsoft.Office.WebExtension.Parameters.MessageToParent];window.external.MessageParent(e);a.onReceiving&&a.onReceiving();if(OSF.AppTelemetry)OSF.AppTelemetry.onMethodDone(a.dispId,a.hostCallArgs,Math.abs(+new Date-d),result);return result}catch(f){var b,c=f.number;if(c)switch(c){case-2146828218:b=OSF.DDA.ErrorCodeManager.errorCodes.ooeNoCapability;break;case-2146827850:default:b=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;break}return b||OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}function i(b){var a=OSF.DDA.DispIdHost.getRichClientDelegateMethods(b);if(a[OSF.DDA.DispIdHost.Delegates.MessageParent]==undefined)a[OSF.DDA.DispIdHost.Delegates.MessageParent]=h;return a}d=i;f=OSF.DDA.RichInitializationReason[f];b=OSF.DDA.SafeArray.Delegate.ParameterMap}else{d=OSF.DDA.DispIdHost.getXLSDelegateMethods;b=OSF.DDA.XLS.Delegate.ParameterMap}OSF._OfficeAppFactory.setHostFacade(new OSF.DDA.DispIdHost.Facade(d,b));Microsoft.Office.WebExtension.initialize(f)}else throw OSF.OUtil.formatString(Strings.OfficeOM.L_OsfControlTypeNotSupported);};OSF.InitializationHelper.prototype.loadAppSpecificScriptAndCreateOM=function(a,e,s){var b;b=".debug.js";var p={"1-15.00":"excel-15"+b,"1-15.01":"excel-15.01"+b,"1-15.02":"excel-15.02"+b,"2-15.00":"word-15"+b,"2-15.01":"word-15.01"+b,"2-15.02":"word-15.02"+b,"4-15.00":"powerpoint-15"+b,"4-15.01":"powerpoint-15.01"+b,"4-15.02":"powerpoint-15.02"+b,"8-15.00":"outlook-15"+b,"8-15.01":"outlook-15.01"+b,"8-15.02":"outlook-15.02"+b,"8-15.03":"outlook-15.03"+b,"8-15.04":"outlook-15.04"+b,"16-15":"excelwebapp-15"+b,"16-15.01":"excelwebapp-15.01"+b,"16-15.02":"excelwebapp-15.02"+b,"64-15":"outlookwebapp-15"+b,"64-15.01":"outlookwebapp-15.01"+b,"128-15.00":"project-15"+b,"128-15.01":"project-15.01"+b,"128-15.02":"project-15.02"+b},m=function(){var a=function(a){a&&OSF.OUtil.loadScript(a,function(){OsfMsAjaxFactory.msAjaxDebug.trace("loaded customized script:"+a)})},c=OSF._OfficeAppFactory.getClientEndPoint(),b=null;if(!c){try{if(typeof window.external.getCustomizedScriptPath!=="undefined")b=window.external.getCustomizedScriptPath()}catch(d){OsfMsAjaxFactory.msAjaxDebug.trace("no script override through window.external.")}a(b)}else try{c.invoke("getCustomizedScriptPathAsync",function(c,b){a(c===0?b:null)},{__timeout__:1e3})}catch(d){OsfMsAjaxFactory.msAjaxDebug.trace("no script override through cross frame communication.")}};OSF.DDA.ErrorCodeManager.initializeErrorMessages(Strings.OfficeOM);var h=this;function f(e){var c,b;if(h._hostInfo.isRichClient)b=OSF.DDA.RichClientSettingsManager.read();else b=a.get_settings();var d=OSF.DDA.SettingsManager.deserializeSettings(b);if(e)c=new OSF.DDA.RefreshableSettings(d);else c=new OSF.DDA.Settings(d);return c}var g=a.get_appVersion(),j=OSF.O15HostSpecificFileVersion.GetFallbackVersion(a.get_appName());if(g>j)g=j;var d=s+p[a.get_appName()+"-"+g],c=function(a,c,b){if(OSF._OfficeAppFactory.getLoadScriptHelper)OSF._OfficeAppFactory.getLoadScriptHelper().loadScript(a,c,b);else OSF.OUtil.loadScript(a,b)};if(a.get_appName()==OSF.AppName.Excel){var o=function(){a.doc=new OSF.DDA.ExcelDocument(a,f(false));e()};c(d,OSF.ConstantNames.HostFileId,o)}else if(a.get_appName()==OSF.AppName.ExcelWebApp){var k=function(){a.doc=new OSF.DDA.ExcelWebAppDocument(a,f(true));e()};c(d,OSF.ConstantNames.HostFileId,k)}else if(a.get_appName()==OSF.AppName.Word){var r=function(){a.doc=new OSF.DDA.WordDocument(a,f(false));e()};c(d,OSF.ConstantNames.HostFileId,r)}else if(a.get_appName()==OSF.AppName.PowerPoint){var l=function(){a.doc=new OSF.DDA.PowerPointDocument(a,f(false));e()};c(d,OSF.ConstantNames.HostFileId,l)}else if(a.get_appName()==OSF.AppName.OutlookWebApp||a.get_appName()==OSF.AppName.Outlook){var n=function(){h._settings=f(false);a.appOM=new OSF.DDA.OutlookAppOm(a,h._webAppState.wnd,e)},i=function(){c(d,OSF.ConstantNames.HostFileId,n)};if(!OsfMsAjaxFactory.isMsAjaxLoaded())OsfMsAjaxFactory.loadMsAjaxFull(i);else i();m()}else if(a.get_appName()==OSF.AppName.Project){var q=function(){a.doc=new OSF.DDA.ProjectDocument(a);e()};c(d,OSF.ConstantNames.HostFileId,q)}else throw OSF.OUtil.formatString(stringNS.L_AppNotExistInitializeNotCalled,a.get_appName());}